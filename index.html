<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="apple-touch-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect fill='%230066cc' width='100' height='100'/><text y='70' x='50' text-anchor='middle' font-size='60' fill='white'>AL</text></svg>">
    <title>Altech Field Lead</title>
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/compliance.css">
    <link rel="stylesheet" href="css/email.css">
    <link rel="stylesheet" href="css/quickref.css">
    <link rel="stylesheet" href="css/accounting.css">
    <link rel="stylesheet" href="css/ezlynx.css">
    <link rel="stylesheet" href="css/quote-compare.css">
    <link rel="stylesheet" href="css/auth.css">
    <link rel="stylesheet" href="css/reminders.css">
    <link rel="stylesheet" href="css/hawksoft.css">
    <link rel="stylesheet" href="css/vin-decoder.css">
    <link rel="stylesheet" href="css/onboarding.css">
    <link rel="stylesheet" href="css/paywall.css">

    <!-- Firebase SDK (compat mode ‚Äî no build step needed) -->
    <script defer src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app-compat.js"></script>
    <script defer src="https://www.gstatic.com/firebasejs/10.12.0/firebase-auth-compat.js"></script>
    <script defer src="https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore-compat.js"></script>
</head>
<body>

    <!-- ‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó -->
    <!-- ‚ïë  ONBOARDING ‚Äî First-run welcome for new team members     ‚ïë -->
    <!-- ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù -->
    <div id="onboardingOverlay" class="onboarding-overlay" style="display:none">
        <div class="onboarding-card">

            <!-- Step 1: Welcome -->
            <div class="onboarding-step active" data-step="1">
                <div class="onboarding-brand">
                    <div class="onboarding-logo">AL</div>
                    <h2>Welcome to Altech</h2>
                    <p>Your insurance toolkit ‚Äî built for speed</p>
                </div>
                <ul class="onboarding-features">
                    <li>
                        <div class="onboarding-feature-icon">üì∑</div>
                        <div class="onboarding-feature-text">
                            <strong>Scan &amp; Auto-Fill</strong>
                            <span>Snap a photo of any policy doc ‚Äî the form fills itself in seconds</span>
                        </div>
                    </li>
                    <li>
                        <div class="onboarding-feature-icon">üì§</div>
                        <div class="onboarding-feature-text">
                            <strong>One-Tap Export</strong>
                            <span>Export to HawkSoft, EZLynx, or PDF with a single tap</span>
                        </div>
                    </li>
                    <li>
                        <div class="onboarding-feature-icon">ÔøΩ</div>
                        <div class="onboarding-feature-text">
                            <strong>Secure Cloud Sync</strong>
                            <span>Your data is encrypted and syncs securely across all your devices</span>
                        </div>
                    </li>
                    <li>
                        <div class="onboarding-feature-icon">üõ°Ô∏è</div>
                        <div class="onboarding-feature-text">
                            <strong>CGL &amp; Compliance</strong>
                            <span>Track policy expirations, bonds, and compliance status</span>
                        </div>
                    </li>
                </ul>
                <div class="onboarding-actions">
                    <button class="onboarding-btn onboarding-btn-primary" onclick="Onboarding.next()">Get Started</button>
                </div>
                <div class="onboarding-dots">
                    <div class="onboarding-dot active"></div>
                    <div class="onboarding-dot"></div>
                    <div class="onboarding-dot"></div>
                    <div class="onboarding-dot"></div>
                </div>
            </div>

            <!-- Step 2: Your Name -->
            <div class="onboarding-step" data-step="2">
                <div class="onboarding-brand">
                    <h2>Let's personalize</h2>
                    <p>Tell us your name so we can greet you properly</p>
                </div>
                <div class="onboarding-input-group">
                    <label for="onboardingName">Your first name</label>
                    <input type="text" id="onboardingName" placeholder="e.g. Austin" autocomplete="given-name" maxlength="30">
                    <div class="onboarding-hint">This shows in the dashboard greeting</div>
                </div>
                <div class="onboarding-actions">
                    <button class="onboarding-btn onboarding-btn-secondary" onclick="Onboarding.prev()">Back</button>
                    <button class="onboarding-btn onboarding-btn-primary" onclick="Onboarding.next()">Continue</button>
                </div>
                <div class="onboarding-dots">
                    <div class="onboarding-dot"></div>
                    <div class="onboarding-dot active"></div>
                    <div class="onboarding-dot"></div>
                    <div class="onboarding-dot"></div>
                </div>
            </div>

            <!-- Step 3: Agency Profile -->
            <div class="onboarding-step" data-step="3">
                <div class="onboarding-brand">
                    <h2>Your Agency</h2>
                    <p>Help us tailor the experience for your agency</p>
                </div>
                <div class="onboarding-input-group">
                    <label for="onboardingAgencyName">Agency name</label>
                    <input type="text" id="onboardingAgencyName" placeholder="e.g. Pacific Shield Insurance" autocomplete="organization" maxlength="80">
                </div>
                <div class="onboarding-input-group">
                    <label for="onboardingAgencyState">State</label>
                    <input type="text" id="onboardingAgencyState" placeholder="e.g. CA" autocomplete="address-level1" maxlength="2" style="text-transform:uppercase;letter-spacing:1px;width:80px">
                </div>
                <div class="onboarding-input-group">
                    <label for="onboardingLicenseNum">License number <span style="font-weight:400;color:var(--text-secondary)">(optional)</span></label>
                    <input type="text" id="onboardingLicenseNum" placeholder="e.g. 0K12345" autocomplete="off" maxlength="30">
                </div>
                <div class="onboarding-actions">
                    <button class="onboarding-btn onboarding-btn-secondary" onclick="Onboarding.prev()">Back</button>
                    <button class="onboarding-btn onboarding-btn-primary" onclick="Onboarding.next()">Continue</button>
                </div>
                <div class="onboarding-dots">
                    <div class="onboarding-dot"></div>
                    <div class="onboarding-dot"></div>
                    <div class="onboarding-dot active"></div>
                    <div class="onboarding-dot"></div>
                </div>
            </div>

            <!-- Step 4: Access Code + finish -->
            <div class="onboarding-step" data-step="4">
                <div class="onboarding-brand">
                    <h2>Almost there!</h2>
                    <p>Enter the access code from your team admin to continue</p>
                </div>
                <div class="onboarding-input-group">
                    <label for="onboardingAccessCode">Access Code</label>
                    <input type="text" id="onboardingAccessCode" placeholder="e.g. ALTECH-2026" autocomplete="off" maxlength="30" style="text-transform:uppercase;letter-spacing:2px;text-align:center;font-size:1.1rem">
                    <div class="onboarding-hint" id="onboardingCodeHint">Ask your manager or team lead for the code</div>
                    <div class="onboarding-code-error" id="onboardingCodeError" style="display:none">Invalid code ‚Äî please try again</div>
                </div>
                <ul class="onboarding-features" style="margin-top:12px">
                    <li>
                        <div class="onboarding-feature-icon">üîí</div>
                        <div class="onboarding-feature-text">
                            <strong>Why a code?</strong>
                            <span>This protects our tools and data ‚Äî only authorized team members can access the app</span>
                        </div>
                    </li>
                </ul>
                <div class="onboarding-actions">
                    <button class="onboarding-btn onboarding-btn-secondary" onclick="Onboarding.prev()">Back</button>
                    <button class="onboarding-btn onboarding-btn-primary" onclick="Onboarding.validateCode()">Activate</button>
                </div>
                <div class="onboarding-dots">
                    <div class="onboarding-dot"></div>
                    <div class="onboarding-dot"></div>
                    <div class="onboarding-dot"></div>
                    <div class="onboarding-dot active"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- ‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó -->
    <!-- ‚ïë  LANDING PAGE ‚Äî Dashboard Shell                          ‚ïë -->
    <!-- ‚ïë  Sections: Header ¬∑ App Grid ¬∑ Quick Reference ¬∑ Footer  ‚ïë -->
    <!-- ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù -->
    <div id="landingPage" class="landing-page">

        <!-- ‚îÄ‚îÄ Section: Hero Header ‚îÄ‚îÄ -->
        <section id="landingHero" class="landing-header" aria-label="Dashboard header">
            <div class="landing-header-pill">
                <div class="landing-header-left">
                    <div class="landing-brand-name">Altech Applications</div>
                    <p class="landing-brand-tagline">Your insurance toolkit &mdash; simple, fast, organized</p>
                </div>
                <div class="landing-header-right">
                    <p class="landing-greeting" id="landingGreeting"></p>
                    <button class="dark-mode-toggle landing-theme-toggle" onclick="App.toggleDarkMode()" title="Toggle dark mode" aria-label="Toggle dark mode">
                        <span class="dark-mode-icon"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/></svg></span>
                    </button>
                    <button id="authUserBtn" class="auth-user-btn" onclick="Auth.showModal()" title="Sign in to sync across devices" aria-label="Account">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
                    </button>
                    <span id="authUserIndicator" class="auth-user-indicator" style="display:none"></span>
                </div>
            </div>
        </section>

        <!-- ‚îÄ‚îÄ Section: Bento App Grid ‚îÄ‚îÄ -->
        <!-- Rendered dynamically from App.toolConfig ‚Üí renderLandingTools() -->
        <!-- Each category gets a labeled group; cards are self-contained components -->
        <section id="landingAppGrid" class="landing-app-grid" aria-label="Tool grid">
            <div class="tools-container" id="toolsGrid">
                <!-- Skeleton placeholders ‚Äî replaced by renderLandingTools() -->
                <div class="skeleton-grid" aria-hidden="true">
                    <div class="skeleton-card"></div><div class="skeleton-card"></div>
                    <div class="skeleton-card"></div><div class="skeleton-card"></div>
                    <div class="skeleton-card"></div><div class="skeleton-card"></div>
                </div>
            </div>
        </section>

        <!-- ‚îÄ‚îÄ Section: Quick Reference (always accessible) ‚îÄ‚îÄ -->
        <section id="landingQuickRef" class="landing-quickref" aria-label="Quick reference">
            <div id="quickrefGrid"></div>
        </section>

        <!-- ‚îÄ‚îÄ Section: Footer ‚îÄ‚îÄ -->
        <footer id="landingFooter" class="landing-footer" aria-label="Footer">
            <div style="text-align:center;font-size:10px;color:#94a3b8;opacity:0.5;letter-spacing:0.5px;">v2.18.1</div>
        </footer>
    </div>

    <!-- BACK BUTTON (shared across all plugins) -->
    <a id="backToHome" href="#home" onclick="App.goHome(); return false;">‚Üê Exit Tool</a>
    <div id="breadcrumbBar"></div>

    <!-- QUOTING TOOL CONTAINER -->
    <div id="quotingTool" class="plugin-container">

    <header>
        <div class="header-top">
            <div class="logo tool-header-brand">
                <span class="logo-controls">
                    <a class="logo-icon-button" href="#home" onclick="App.goHome(); return false;" aria-label="Back to home">
                        <span class="logo-icon"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg></span>
                    </a>
                    <button class="dark-mode-toggle" onclick="App.toggleDarkMode()" title="Toggle dark mode" aria-label="Toggle dark mode">
                        <span class="dark-mode-icon"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/></svg></span>
                    </button>
                </span>
                <span>Insurance Intake</span>
            </div>
            <div class="header-right">
                <div id="saveIndicator" class="save-indicator">‚úì Saved</div>
            </div>
        </div>
        <div id="stepTitle" class="step-title">Step 1 of 4: Client Information</div>
        <div class="progress-track"><div id="progressBar" class="progress-fill"></div></div>
    </header>

    <main id="mainContainer">
        <!-- STEP 0: QUICK START -->
        <div id="step-0" class="step">
            <!-- New Client & Recent Clients (primary action ‚Äî first) -->
            <div class="card" id="step0ClientCard">
                <h2>üë§ Begin Intake</h2>
                <p class="section-subtitle">Start a new client or restore a previous one</p>
                <button class="btn btn-primary" onclick="App.startFresh()" style="width:100%;margin-bottom:12px;">‚ú® New Client</button>
                <div id="step0ClientHistoryList"></div>
            </div>

            <!-- Saved Drafts (Quick Load) -->
            <div class="card" id="quickStartDraftsCard" style="display:none;">
                <h2>üìã Saved Drafts</h2>
                <p class="section-subtitle">Tap a draft to resume editing</p>
                <div id="quickStartDraftList"></div>
            </div>

            <!-- Smart Scan -->
            <div class="card">
                <h2>üöÄ Smart Scan</h2>
                <p class="section-subtitle">Upload a policy document or driver license to auto-fill the form</p>

                <!-- Desktop drag-and-drop zone for policy documents -->
                <div id="scanDropZone" class="scan-drop-zone" style="display:none;">
                    <div class="drop-icon">üìÑ</div>
                    <div class="drop-label">Drop policy documents here</div>
                    <div class="drop-hint">PDF or image files ‚Ä¢ Drag from your desktop</div>
                </div>

                <div class="scan-actions">
                    <button class="btn btn-primary" onclick="App.openScanPicker()">üì∏ Upload Policy Document</button>
                    <button class="btn btn-primary" onclick="App.openInitialDriverLicensePicker()">ü™™ Upload Driver License</button>
                    <input id="policyScanInput" type="file" accept="image/*,application/pdf" capture="environment" multiple class="hidden" />
                    <input id="initialDlScanInput" type="file" accept="image/*" capture="environment" class="hidden" onchange="App.handleInitialDriverLicenseFile(this.files[0])" />
                    <input id="docIntelInput" type="file" accept="image/*,application/pdf" multiple class="hidden" />
                </div>

                <div id="scanPreview" class="scan-preview"></div>
                <div id="initialDlPreview" class="scan-preview"></div>
                <div id="docIntelPreview" class="scan-preview"></div>
                
                <div id="scanStatus" class="hint hidden"></div>
                <div id="initialDlStatus" class="hint hidden"></div>
                <div id="docIntelStatus" class="hint hidden"></div>
                
                <div id="scanResults"></div>
                <div id="initialDlResults"></div>
                <div id="docIntelResults"></div>
                
                <div id="scanCoverage" class="hint" style="margin-top:12px; display:none;">Scan coverage: 0/0 fields applied</div>
            </div>
        </div>

        <!-- STEP 1: CLIENT INFORMATION -->
        <div id="step-1" class="step hidden">
            <div class="hint" style="margin-bottom:16px;">
                üí° Tip: Use the policy/document scans on the previous step to auto-fill this form.
            </div>
            <div class="card">
                <h2>About You</h2>
                <p class="section-subtitle">Let's start with your basic information</p>
                
                <div class="grid-2-full">
                    <div>
                        <label class="label">First Name</label>
                        <div class="input-with-action">
                            <input type="text" id="firstName" placeholder="John" autocomplete="given-name">
                            <button type="button" class="input-action-btn pronunciation-btn" id="pronBtnFirst" onclick="App.togglePronunciation('first')" title="Name pronunciation">üîä</button>
                            <div class="pronunciation-popup" id="pronPopupFirst">
                                <input type="text" id="firstNamePhonetic" placeholder="e.g. AW-stin" readonly>
                                <div class="popup-actions">
                                    <button type="button" class="popup-btn-gen" onclick="App.generateNamePronunciation()">Generate</button>
                                    <button type="button" class="popup-btn-close" onclick="App.togglePronunciation('first')">Close</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div>
                        <label class="label">Last Name</label>
                        <div class="input-with-action">
                            <input type="text" id="lastName" placeholder="Smith" autocomplete="family-name">
                            <button type="button" class="input-action-btn pronunciation-btn" id="pronBtnLast" onclick="App.togglePronunciation('last')" title="Name pronunciation">üîä</button>
                            <div class="pronunciation-popup" id="pronPopupLast">
                                <input type="text" id="lastNamePhonetic" placeholder="e.g. SMITH" readonly>
                                <div class="popup-actions">
                                    <button type="button" class="popup-btn-gen" onclick="App.generateNamePronunciation()">Generate</button>
                                    <button type="button" class="popup-btn-close" onclick="App.togglePronunciation('last')">Close</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div>
                        <label class="label">Prefix</label>
                        <select id="prefix">
                            <option value="">--</option>
                            <option value="MR">Mr.</option>
                            <option value="MRS">Mrs.</option>
                            <option value="MS">Ms.</option>
                            <option value="DR">Dr.</option>
                        </select>
                    </div>
                    <div>
                        <label class="label">Suffix</label>
                        <select id="suffix">
                            <option value="">--</option>
                            <option value="JR">Jr.</option>
                            <option value="SR">Sr.</option>
                            <option value="I">I</option>
                            <option value="II">II</option>
                            <option value="III">III</option>
                        </select>
                    </div>

                    <div><label class="label">Date of Birth</label><input type="date" id="dob"></div>
                    <div>
                        <label class="label">Gender</label>
                        <select id="gender">
                            <option value="">Select...</option>
                            <option value="M">Male</option>
                            <option value="F">Female</option>
                            <option value="X">Not Specified</option>
                        </select>
                    </div>

                    <div><label class="label">Email Address</label><input type="email" id="email" placeholder="john@example.com" autocomplete="email"></div>
                    <div><label class="label">Phone Number</label><input type="tel" id="phone" placeholder="(555) 123-4567" autocomplete="tel"></div>

                    <div>
                        <label class="label">Marital Status</label>
                        <select id="maritalStatus">
                            <option value="">Select...</option>
                            <option value="Single">Single</option>
                            <option value="Married">Married</option>
                            <option value="Domestic Partner">Domestic Partner</option>
                            <option value="Widowed">Widowed</option>
                            <option value="Separated">Separated</option>
                            <option value="Divorced">Divorced</option>
                        </select>
                    </div>
                    <div></div>
                </div>

                <!-- Co-Applicant Toggle -->
                <div class="co-applicant-toggle">
                    <label class="checkbox-row">
                        <input type="checkbox" id="hasCoApplicant" onchange="App.toggleCoApplicant()">
                        <span style="font-weight:600;">Add Co-Applicant / Spouse</span>
                    </label>
                </div>

                <!-- Co-Applicant Fields -->
                <div id="coApplicantSection" class="co-applicant-section">
                    <h3>Co-Applicant Information</h3>
                    <div class="grid-2-full">
                        <div>
                            <label class="label">First Name</label>
                            <input type="text" id="coFirstName" placeholder="Jane">
                        </div>
                        <div>
                            <label class="label">Last Name</label>
                            <input type="text" id="coLastName" placeholder="Smith">
                        </div>
                        <div>
                            <label class="label">Date of Birth</label>
                            <input type="date" id="coDob">
                        </div>
                        <div>
                            <label class="label">Gender</label>
                            <select id="coGender">
                                <option value="">Select...</option>
                                <option value="M">Male</option>
                                <option value="F">Female</option>
                            </select>
                        </div>
                        <div>
                            <label class="label">Email</label>
                            <input type="email" id="coEmail" placeholder="jane@email.com">
                        </div>
                        <div>
                            <label class="label">Phone</label>
                            <input type="tel" id="coPhone" placeholder="(555) 555-5555">
                        </div>
                        <div>
                            <label class="label">Relationship</label>
                            <select id="coRelationship">
                                <option value="Spouse">Spouse</option>
                                <option value="Domestic Partner">Domestic Partner</option>
                                <option value="Other">Other</option>
                            </select>
                        </div>
                        <div></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- STEP 2: COVERAGE TYPE -->
        <div id="step-2" class="step hidden">
            <div class="card">
                <h2>What would you like to insure?</h2>
                <p class="section-subtitle">Select the coverage type(s) you need</p>
                
                <div class="radio-grid">
                    <label class="radio-card"><input type="radio" name="qType" value="home" onchange="App.handleType()">
                        <div class="radio-card-content">
                            <span style="font-size:48px">üè†</span>
                            <span style="margin-top:12px; font-size:16px; font-weight:600">HOME</span>
                            <span style="font-size:13px; color:var(--text-secondary); margin-top:4px">Property insurance</span>
                        </div>
                    </label>
                    <label class="radio-card"><input type="radio" name="qType" value="auto" onchange="App.handleType()">
                        <div class="radio-card-content">
                            <span style="font-size:48px">üöó</span>
                            <span style="margin-top:12px; font-size:16px; font-weight:600">AUTO</span>
                            <span style="font-size:13px; color:var(--text-secondary); margin-top:4px">Vehicle insurance</span>
                        </div>
                    </label>
                    <label class="radio-card"><input type="radio" name="qType" value="both" checked onchange="App.handleType()">
                        <div class="radio-card-content">
                            <span style="font-size:48px">üéØ</span>
                            <span style="margin-top:12px; font-size:16px; font-weight:600">HOME & AUTO</span>
                            <span style="font-size:13px; color:var(--text-secondary); margin-top:4px">Bundle coverage</span>
                        </div>
                    </label>
                </div>
            </div>

            <div class="card">
                <h2>Demographics</h2>
                <p class="section-subtitle">This helps us find the best coverage options</p>
                
                <div class="grid-2">
                    <div>
                        <label class="label">Education Level</label>
                        <select id="education">
                            <option value="">Select...</option>
                            <option value="No High School Diploma">No High School Diploma</option>
                            <option value="High School Diploma">High School Diploma</option>
                            <option value="Some College - No Degree">Some College - No Degree</option>
                            <option value="Vocational/Technical Degree">Vocational/Technical Degree</option>
                            <option value="Associates Degree">Associates Degree</option>
                            <option value="Bachelors">Bachelors</option>
                            <option value="Masters">Masters</option>
                            <option value="Phd">PhD</option>
                            <option value="Medical Degree">Medical Degree</option>
                            <option value="Law Degree">Law Degree</option>
                        </select>
                    </div>
                    <div>
                        <label class="label">Occupation</label>
                        <input type="text" id="occupation" placeholder="e.g. Insurance Agent" oninput="App.save(event)">
                    </div>
                    <div>
                        <label class="label">Industry</label>
                        <select id="industry">
                            <option value="">Select...</option>
                            <option value="Homemaker/House person">Homemaker/House person</option>
                            <option value="Retired">Retired</option>
                            <option value="Disabled">Disabled</option>
                            <option value="Unemployed">Unemployed</option>
                            <option value="Student">Student</option>
                            <option value="Agriculture/Forestry/Fishing">Agriculture/Forestry/Fishing</option>
                            <option value="Art/Design/Media">Art/Design/Media</option>
                            <option value="Banking/Finance/Real Estate">Banking/Finance/Real Estate</option>
                            <option value="Business/Sales/Office">Business/Sales/Office</option>
                            <option value="Construction/Energy Trades">Construction/Energy Trades</option>
                            <option value="Education/Library">Education/Library</option>
                            <option value="Engineer/Architect/Science/Math">Engineer/Architect/Science/Math</option>
                            <option value="Government/Military">Government/Military</option>
                            <option value="Information Technology">Information Technology</option>
                            <option value="Insurance">Insurance</option>
                            <option value="Legal/Law Enforcement/Security">Legal/Law Enforcement/Security</option>
                            <option value="Maintenance/Repair/Housekeeping">Maintenance/Repair/Housekeeping</option>
                            <option value="Manufacturing/Production">Manufacturing/Production</option>
                            <option value="Medical/Social Services/Religion">Medical/Social Services/Religion</option>
                            <option value="Personal Care/Service">Personal Care/Service</option>
                            <option value="Restaurant/Hotel Services">Restaurant/Hotel Services</option>
                            <option value="Sports/Recreation">Sports/Recreation</option>
                            <option value="Travel/Transportation/Warehousing">Travel/Transportation/Warehousing</option>
                            <option value="Other">Other</option>
                        </select>
                    </div>
                </div>
            </div>
        </div>

        <!-- STEP 3: PROPERTY DETAILS -->
        <div id="step-3" class="step hidden">
          <div class="prop-layout">
            <!-- ‚ïê‚ïê‚ïê LEFT COLUMN: Form Fields ‚ïê‚ïê‚ïê -->
            <div class="prop-main">

            <div class="card">
                <h2>Property Location</h2>
                <p class="section-subtitle">Where is the property located?</p>
                
                <div class="grid-addr-row1">
                    <div><label class="label">Street Address</label><input type="text" id="addrStreet" placeholder="123 Main St" autocomplete="off"></div>
                </div>
                <div class="grid-addr-row2">
                    <div><label class="label">City</label><input type="text" id="addrCity" placeholder="Vancouver" autocomplete="off"></div>
                    <div><label class="label">State</label><input type="text" id="addrState" value="WA" autocomplete="off"></div>
                    <div><label class="label">Zip</label><input type="tel" id="addrZip" placeholder="98686"></div>
                    <div><label class="label">County</label>
                        <select id="county" style="font-size: 13px !important; padding: 8px 8px;">
                            <option value="">Auto-fills ‚ú®</option>
                            <option value="Adams">Adams</option>
                            <option value="Asotin">Asotin</option>
                            <option value="Benton">Benton</option>
                            <option value="Chelan">Chelan</option>
                            <option value="Clallam">Clallam</option>
                            <option value="Clark">Clark</option>
                            <option value="Columbia">Columbia</option>
                            <option value="Cowlitz">Cowlitz</option>
                            <option value="Douglas">Douglas</option>
                            <option value="Ferry">Ferry</option>
                            <option value="Franklin">Franklin</option>
                            <option value="Garfield">Garfield</option>
                            <option value="Grant">Grant</option>
                            <option value="Grays Harbor">Grays Harbor</option>
                            <option value="Island">Island</option>
                            <option value="Jefferson">Jefferson</option>
                            <option value="King">King</option>
                            <option value="Kitsap">Kitsap</option>
                            <option value="Kittitas">Kittitas</option>
                            <option value="Klickitat">Klickitat</option>
                            <option value="Lewis">Lewis</option>
                            <option value="Lincoln">Lincoln</option>
                            <option value="Mason">Mason</option>
                            <option value="Okanogan">Okanogan</option>
                            <option value="Pacific">Pacific</option>
                            <option value="Pend Oreille">Pend Oreille</option>
                            <option value="Pierce">Pierce</option>
                            <option value="San Juan">San Juan</option>
                            <option value="Skagit">Skagit</option>
                            <option value="Skamania">Skamania</option>
                            <option value="Snohomish">Snohomish</option>
                            <option value="Spokane">Spokane</option>
                            <option value="Stevens">Stevens</option>
                            <option value="Thurston">Thurston</option>
                            <option value="Wahkiakum">Wahkiakum</option>
                            <option value="Walla Walla">Walla Walla</option>
                            <option value="Whatcom">Whatcom</option>
                            <option value="Whitman">Whitman</option>
                            <option value="Yakima">Yakima</option>
                        </select>
                    </div>
                </div>

                <!-- Smart Scan: hero button -->
                <div style="margin-top: 14px;">
                    <button class="btn-smart-scan" onclick="App.smartAutoFill()" title="Smart property lookup ‚Äî auto-fills county, year built, sqft, hazards & more" id="smartFillBtn">‚ú® Smart Scan</button>
                </div>

                <!-- Secondary tools row -->
                <div class="utility-buttons" style="margin-top: 8px; justify-content: center;">
                    <button class="btn-utility" onclick="App.openZillow()" title="Search this address on Zillow" style="flex: 0 1 auto; font-size: 12px; padding: 7px 14px;">üîç Zillow</button>
                    <button class="btn-utility" onclick="App.openPropertyRecords()" title="Copies address to clipboard & opens county assessor site" style="flex: 0 1 auto; font-size: 12px; padding: 7px 14px;">üèõÔ∏è Assessor</button>
                    <button class="btn-utility" onclick="App.importPropertyFromExtension()" title="Import property data scraped by the Chrome Extension from Zillow/GIS" style="flex: 0 1 auto; font-size: 12px; padding: 7px 14px; background: linear-gradient(135deg, #ff9500, #e68600); color: white;">üì• Import</button>
                </div>

                <!-- Hidden file input kept for backward compatibility -->
                <input type="file" id="gisUploadInput" accept="image/*,.pdf" multiple style="display:none" onchange="App.handleGISUpload(event)">
                <div id="gisUploadStatus" class="hidden" style="margin-top: 8px; padding: 10px; border-radius: 8px; background: var(--card-bg); font-size: 13px; text-align: center;"></div>
                <div id="gisUploadResults" style="margin-top: 8px;"></div>
            </div>

            <div class="card">
                <h2>Home Basics</h2>
                <p class="section-subtitle">Tell us about your property</p>
                
                <label class="label">Dwelling Usage</label>
                <select id="dwellingUsage">
                    <option value="">Select...</option>
                    <option value="Primary">Primary</option>
                    <option value="Secondary">Secondary</option>
                    <option value="Seasonal">Seasonal</option>
                    <option value="Farm">Farm</option>
                    <option value="COC">COC</option>
                    <option value="Rental">Rental</option>
                    <option value="Vacant">Vacant</option>
                </select>
                
                <label class="label">Occupancy Type</label>
                <select id="occupancyType">
                    <option value="">Select...</option>
                    <option value="Owner Occupied">Owner Occupied</option>
                    <option value="Renter Occupied">Renter Occupied</option>
                    <option value="Unoccupied">Unoccupied</option>
                    <option value="Vacant">Vacant</option>
                </select>
                
                <label class="label">Dwelling Type</label>
                <select id="dwellingType">
                    <option value="">Select...</option>
                    <option value="One Family">One Family</option>
                    <option value="Two Family">Two Family</option>
                    <option value="Three Family">Three Family</option>
                    <option value="Four Family">Four Family</option>
                    <option value="Condo">Condo</option>
                    <option value="Townhome">Townhome</option>
                    <option value="Row House">Row House</option>
                </select>
                
                <div class="grid-2">
                    <div><label class="label">Number of Stories</label>
                        <select id="numStories">
                            <option value="">Select...</option>
                            <option value="1">1</option>
                            <option value="1.5">1.5</option>
                            <option value="2">2</option>
                            <option value="2.5">2.5</option>
                            <option value="3">3</option>
                            <option value="3.5">3.5</option>
                            <option value="4">4</option>
                            <option value="Bi-Level">Bi-Level</option>
                            <option value="Tri-Level">Tri-Level</option>
                        </select>
                    </div>
                    <div><label class="label">Bedrooms</label><input type="number" id="bedrooms" min="1" max="20" value="3"></div>
                </div>

                <div class="grid-2">
                    <div><label class="label">Full Bathrooms</label><input type="number" id="fullBaths" min="1" max="10" value="2"></div>
                    <div><label class="label">Half Bathrooms</label><input type="number" id="halfBaths" min="0" max="5" value="0"></div>
                </div>
                
                <div class="grid-2">
                    <div><label class="label">Square Footage</label><input type="tel" id="sqFt" placeholder="2000"></div>
                    <div><label class="label">Year Built</label><input type="tel" id="yrBuilt" placeholder="1990" oninput="App.checkUpdates()"></div>
                </div>

                <div class="grid-2">
                    <div><label class="label">Lot Size (acres)</label><input type="text" id="lotSize" placeholder="0.25"></div>
                    <div><label class="label">Number of Occupants</label><input type="number" id="numOccupants" min="1" max="20" placeholder="2"></div>
                </div>
                
                <div class="grid-2">
                    <div><label class="label">Home Purchase Date</label>
                    <input type="date" id="purchaseDate" onchange="App.calculateResidenceTime()">
                    <span id="residenceTimeDisplay" style="font-size: 12px; color: var(--text-secondary); margin-top: 2px; display: block;"></span></div>
                    <div><label class="label">Years at Address</label><input type="text" id="yearsAtAddress" placeholder="5"></div>
                </div>
            </div>

            <details class="card section-accordion" open>
                <summary>
                    <div><h2 style="margin:0">Construction &amp; Roof</h2>
                    <p class="section-subtitle" style="margin:4px 0 0">Materials, foundation, garage, and roofing</p></div>
                </summary>
                <div class="accordion-body">

                <div class="grid-2">
                    <div><label class="label">Construction Style</label>
                    <select id="constructionStyle">
                        <option value="">Select...</option>
                        <option value="Ranch">Ranch</option>
                        <option value="Colonial">Colonial</option>
                        <option value="Cape Cod">Cape Cod</option>
                        <option value="Bi-Level">Bi-Level</option>
                        <option value="Bi-Level/Row Center">Bi-Level / Row Center</option>
                        <option value="Bi-Level/Row End">Bi-Level / Row End</option>
                        <option value="Split Level">Split Level</option>
                        <option value="Split Foyer">Split Foyer</option>
                        <option value="Tri-Level">Tri-Level</option>
                        <option value="Tri-Level Center">Tri-Level Center</option>
                        <option value="Raised Ranch">Raised Ranch</option>
                        <option value="Rambler">Rambler</option>
                        <option value="Bungalow">Bungalow</option>
                        <option value="Cottage">Cottage</option>
                        <option value="Contemporary">Contemporary</option>
                        <option value="Victorian">Victorian</option>
                        <option value="Ornate Victorian">Ornate Victorian</option>
                        <option value="Queen Anne">Queen Anne</option>
                        <option value="Federal Colonial">Federal Colonial</option>
                        <option value="Mediterranean">Mediterranean</option>
                        <option value="Southwest Adobe">Southwest Adobe</option>
                        <option value="Townhouse">Townhouse</option>
                        <option value="Townhouse Center">Townhouse Center</option>
                        <option value="Townhouse End">Townhouse End</option>
                        <option value="Rowhouse">Rowhouse</option>
                        <option value="Rowhouse Center">Rowhouse Center</option>
                        <option value="Rowhouse End">Rowhouse End</option>
                        <option value="Condo">Condo</option>
                        <option value="Coop">Coop</option>
                        <option value="Apartment">Apartment</option>
                        <option value="Dwelling">Dwelling</option>
                        <option value="Backsplit">Backsplit</option>
                        <option value="Substandard">Substandard</option>
                    </select></div>
                    <div><label class="label">Exterior Walls</label>
                    <select id="exteriorWalls">
                        <option value="">Select...</option>
                        <option value="Aluminum/Vinyl">Aluminum / Vinyl</option>
                        <option value="Siding, Vinyl">Siding, Vinyl</option>
                        <option value="Siding, Aluminum">Siding, Aluminum</option>
                        <option value="Siding, Wood">Siding, Wood</option>
                        <option value="Siding, Hardboard">Siding, Hardboard</option>
                        <option value="Siding, Steel">Siding, Steel</option>
                        <option value="Siding, T-111">Siding, T-111</option>
                        <option value="Siding, Plywood">Siding, Plywood</option>
                        <option value="Brick">Brick</option>
                        <option value="Brick Veneer">Brick Veneer</option>
                        <option value="Brick Veneer, Custom">Brick Veneer, Custom</option>
                        <option value="Brick on Block">Brick on Block</option>
                        <option value="Brick on Block, Custom">Brick on Block, Custom</option>
                        <option value="Solid Brick">Solid Brick</option>
                        <option value="Solid Brick, Custom">Solid Brick, Custom</option>
                        <option value="Stucco">Stucco</option>
                        <option value="Stucco on Block">Stucco on Block</option>
                        <option value="Stucco on Frame">Stucco on Frame</option>
                        <option value="Stone Veneer">Stone Veneer</option>
                        <option value="Stone Veneer, Custom">Stone Veneer, Custom</option>
                        <option value="Stone on Block">Stone on Block</option>
                        <option value="Stone on Block, Custom Stone">Stone on Block, Custom Stone</option>
                        <option value="Solid Stone">Solid Stone</option>
                        <option value="Solid Stone, Custom">Solid Stone, Custom</option>
                        <option value="Solid Brownstone">Solid Brownstone</option>
                        <option value="Cement Fiber Shingles">Cement Fiber Shingles</option>
                        <option value="Clapboard">Clapboard</option>
                        <option value="Concrete Decorative Block, Painted">Concrete Decorative Block</option>
                        <option value="Ext Insul and Finish Sys (EIFS)">EIFS (Synthetic Stucco)</option>
                        <option value="Fire Resistant">Fire Resistant</option>
                        <option value="Logs">Logs</option>
                        <option value="Poured Concrete">Poured Concrete</option>
                        <option value="Adobe">Adobe</option>
                        <option value="Barn Plank">Barn Plank</option>
                        <option value="Slump Block">Slump Block</option>
                        <option value="Victorian Scalloped Shakes">Victorian Scalloped Shakes</option>
                        <option value="Wood Shakes">Wood Shakes</option>
                        <option value="Window Wall">Window Wall</option>
                    </select></div>
                </div>

                <div class="grid-2">
                    <div><label class="label">Foundation Type</label>
                    <select id="foundation">
                        <option value="">Select...</option>
                        <option value="Slab">Slab</option>
                        <option value="Crawl Space - Enclosed">Crawl Space - Enclosed</option>
                        <option value="Crawl Space - Open">Crawl Space - Open</option>
                        <option value="Basement - Finished">Basement - Finished</option>
                        <option value="Basement - Partially Finished">Basement - Partially Finished</option>
                        <option value="Basement - Unfinished">Basement - Unfinished</option>
                        <option value="Basement - Walkout">Basement - Walkout</option>
                        <option value="Daylight Basement - Finished">Daylight Basement - Finished</option>
                        <option value="Daylight Basement - Partially Finished">Daylight Basement - Partially Finished</option>
                        <option value="Daylight Basement - Unfinished">Daylight Basement - Unfinished</option>
                        <option value="Hillside Foundation">Hillside Foundation</option>
                        <option value="Piers">Piers</option>
                        <option value="Pilings/stilts">Pilings / Stilts</option>
                        <option value="Other">Other</option>
                    </select></div>
                    <div><label class="label">Kitchen/Bath Quality</label>
                    <select id="kitchenQuality">
                        <option value="">Select...</option>
                        <option value="Builder's Grade">Builder's Grade</option>
                        <option value="Semi-Custom">Semi-Custom</option>
                        <option value="Custom">Custom</option>
                    </select></div>
                </div>

                <div class="grid-2">
                    <div><label class="label">Garage Type</label>
                    <select id="garageType">
                        <option value="">Select...</option>
                        <option value="Attached">Attached</option>
                        <option value="Detached">Detached</option>
                        <option value="Built-in">Built-in</option>
                        <option value="Carport">Carport</option>
                        <option value="None">None</option>
                    </select></div>
                    <div><label class="label">Garage Spaces</label>
                    <input type="number" id="garageSpaces" min="0" max="10" placeholder="2"></div>
                </div>

                <div class="divider" style="margin:12px 0;"></div>
                <h3 style="font-size:15px; font-weight:600; margin-bottom:8px;">Roof</h3>

                <div class="grid-12">
                    <div class="span-8"><label class="label">Roof Type</label>
                        <select id="roofType">
                            <option value="">Select...</option>
                            <option value="Architectural Shingles">Architectural Shingles</option>
                            <option value="Asphalt Shingles">Asphalt Shingles</option>
                            <option value="Composition">Composition</option>
                            <option value="Metal(pitched)">Metal (Pitched)</option>
                            <option value="Metal(flat)">Metal (Flat)</option>
                            <option value="Tile(clay)">Tile (Clay)</option>
                            <option value="Tile(concrete)">Tile (Concrete)</option>
                            <option value="Tile(spanish)">Tile (Spanish)</option>
                            <option value="Wood Shake">Wood Shake</option>
                            <option value="Wood Shingles">Wood Shingles</option>
                            <option value="Wood Fiberglass Shingles">Wood Fiberglass Shingles</option>
                            <option value="Slate">Slate</option>
                            <option value="Tar And Gravel">Tar and Gravel</option>
                            <option value="Tar">Tar</option>
                            <option value="Rubber Flat">Rubber (Flat)</option>
                            <option value="Rubber(pitched)">Rubber (Pitched)</option>
                            <option value="Rolled Paper(flat)">Rolled Paper (Flat)</option>
                            <option value="Rolled Paper(pitched)">Rolled Paper (Pitched)</option>
                            <option value="Corrugated Steel(pitched)">Corrugated Steel (Pitched)</option>
                            <option value="Corrugated Steel(flat)">Corrugated Steel (Flat)</option>
                            <option value="Copper(pitched)">Copper (Pitched)</option>
                            <option value="Copper(flat)">Copper (Flat)</option>
                            <option value="Tin(pitched)">Tin (Pitched)</option>
                            <option value="Tin(flat)">Tin (Flat)</option>
                            <option value="Fiberglass">Fiberglass</option>
                            <option value="Mineral Fiber Shake">Mineral Fiber Shake</option>
                            <option value="Solar">Solar</option>
                            <option value="Foam">Foam</option>
                            <option value="Gravel">Gravel</option>
                            <option value="Rock">Rock</option>
                            <option value="Plastic(flat)">Plastic (Flat)</option>
                            <option value="Plastic(pitched)">Plastic (Pitched)</option>
                            <option value="Thatch">Thatch</option>
                            <option value="Asbestos">Asbestos</option>
                            <option value="Other">Other</option>
                        </select>
                    </div>
                    <div class="span-4"><label class="label">Roof Shape</label>
                        <select id="roofShape">
                            <option value="">Select...</option>
                            <option value="Gable">Gable</option>
                            <option value="Hip">Hip</option>
                            <option value="Flat">Flat</option>
                            <option value="Gambrel">Gambrel</option>
                            <option value="Mansard">Mansard</option>
                            <option value="Shed">Shed</option>
                            <option value="Dormer">Dormer</option>
                            <option value="Pyramid">Pyramid</option>
                            <option value="Turret">Turret</option>
                            <option value="Other">Other</option>
                        </select>
                    </div>
                </div>
                <div class="grid-12">
                    <div class="span-4"><label class="label">Year Roof Updated</label>
                    <input type="tel" id="roofYr" placeholder="2015"></div>
                </div>

                </div> <!-- end .accordion-body -->
            </details>

            <div id="updatesCard" class="card hidden">
                <h2>System Updates</h2>
                <p class="section-subtitle">When were these systems last updated? (Home built before 2000)</p>
                
                <div class="grid-2">
                    <div><label class="label">Heating Update</label>
                        <select id="heatYr">
                            <option value="">Select...</option>
                            <option value="Complete Update">Complete Update</option>
                            <option value="Partial Update">Partial Update</option>
                            <option value="Not Updated">Not Updated</option>
                        </select>
                    </div>
                    <div><label class="label">Plumbing Update</label>
                        <select id="plumbYr">
                            <option value="">Select...</option>
                            <option value="Complete Update">Complete Update</option>
                            <option value="Partial Update">Partial Update</option>
                            <option value="Not Updated">Not Updated</option>
                        </select>
                    </div>
                </div>
                <div class="grid-2">
                    <div><label class="label">Electrical Update</label>
                        <select id="elecYr">
                            <option value="">Select...</option>
                            <option value="Complete Update">Complete Update</option>
                            <option value="Partial Update">Partial Update</option>
                            <option value="Not Updated">Not Updated</option>
                        </select>
                    </div>
                    <div><label class="label">Roofing Update</label>
                        <select id="roofUpdate">
                            <option value="">Select...</option>
                            <option value="Complete Update">Complete Update</option>
                            <option value="Partial Update">Partial Update</option>
                            <option value="Not Updated">Not Updated</option>
                        </select>
                    </div>
                </div>
            </div>

            <div class="card">
            <details class="section-accordion" open>
                <summary>Systems &amp; Utilities</summary>
                <div class="accordion-body">
                    <div class="grid-12">
                        <div class="span-6">
                            <label class="label">Heating Type</label>
                            <select id="heatingType">
                                <option value="">Select...</option>
                                <option value="Gas - Forced Air">Gas - Forced Air</option>
                                <option value="Gas - Hot Water">Gas - Hot Water</option>
                                <option value="Gas">Gas (Other)</option>
                                <option value="Electric">Electric</option>
                                <option value="Oil - Forced Air">Oil - Forced Air</option>
                                <option value="Oil - Hot Water">Oil - Hot Water</option>
                                <option value="Oil">Oil (Other)</option>
                                <option value="Other - Forced Air">Other - Forced Air</option>
                                <option value="Other - Hot Water">Other - Hot Water</option>
                                <option value="Solid Fuel">Solid Fuel</option>
                                <option value="Other">Other</option>
                            </select>
                        </div>
                        <div class="span-6">
                            <label class="label">Cooling System</label>
                            <select id="cooling">
                                <option value="">Select...</option>
                                <option value="Central Air">Central Air</option>
                                <option value="Window Units">Window Units</option>
                                <option value="None">None</option>
                            </select>
                        </div>
                    </div>

                    <label class="disclosure-check" id="secondaryHeatToggle">
                        <input type="checkbox" id="hasSecondaryHeating">
                        <span>Has Secondary Heating?</span>
                    </label>
                    <div id="secondaryHeatingWrapper" class="disclosure-hidden">
                        <label class="label">Secondary Heating Source</label>
                        <select id="secondaryHeating">
                            <option value="">None</option>
                            <option value="Wood Professionally Installed">Wood (Professionally Installed)</option>
                            <option value="Wood Non-Professionally Installed">Wood (Non-Professionally Installed)</option>
                            <option value="Coal Professionally Installed">Coal (Professionally Installed)</option>
                            <option value="Coal Non-Professionally Installed">Coal (Non-Professionally Installed)</option>
                            <option value="Electric">Electric</option>
                            <option value="Electric Portable Heater">Electric Portable Heater</option>
                            <option value="Kerosene">Kerosene</option>
                            <option value="Kerosene Portable Heater">Kerosene Portable Heater</option>
                            <option value="Liquid Propane">Liquid Propane</option>
                            <option value="Liquid Propane Portable Heater">Liquid Propane Portable Heater</option>
                            <option value="Natural Gas">Natural Gas</option>
                            <option value="Oil">Oil</option>
                            <option value="Solar Professionally Installed">Solar (Professionally Installed)</option>
                            <option value="Solar Non-Professionally Installed">Solar (Non-Professionally Installed)</option>
                            <option value="Other">Other</option>
                        </select>
                    </div>

                    <div class="grid-2">
                        <div><label class="label">Sewer</label>
                            <select id="sewer">
                                <option value="">Select...</option>
                                <option value="Public">Public</option>
                                <option value="Septic">Septic</option>
                            </select>
                        </div>
                        <div><label class="label">Water Source</label>
                            <select id="waterSource">
                                <option value="">Select...</option>
                                <option value="Public">Public</option>
                                <option value="Well">Well</option>
                            </select>
                        </div>
                    </div>

                    <div class="grid-2">
                        <div><label class="label">Primary Flooring</label>
                            <select id="flooring">
                                <option value="">Select...</option>
                                <option value="Hardwood">Hardwood</option>
                                <option value="Carpet">Carpet</option>
                                <option value="Tile">Tile</option>
                                <option value="Laminate">Laminate</option>
                                <option value="Mixed">Mixed</option>
                            </select>
                        </div>
                        <div><label class="label">Number of Fireplaces</label>
                            <input type="number" id="numFireplaces" min="0" max="5" placeholder="0">
                        </div>
                    </div>
                </div>
            </details>
            </div>

            <div class="card">
                <h2>Safety & Location</h2>
                <p class="section-subtitle">Fire protection and security</p>
                
                <div class="grid-3">
                    <div><label class="label">Distance to Fire Station (Miles)</label><input type="number" id="fireStationDist" step="0.1" placeholder="2.5"></div>
                    <div>
                        <label class="label">Feet to Fire Hydrant</label>
                        <select id="fireHydrantFeet">
                            <option value="">Select...</option>
                            <option value="1-500">1-500</option>
                            <option value="501-600">501-600</option>
                            <option value="601-1000">601-1000</option>
                            <option value="1001-1100">1001-1100</option>
                            <option value="1101-1200">1101-1200</option>
                            <option value="1201-1300">1201-1300</option>
                            <option value="1301-1400">1301-1400</option>
                            <option value="1401-1500">1401-1500</option>
                            <option value="1501 and Greater">1501+</option>
                            <option value="None in Area">None in Area</option>
                        </select>
                    </div>
                    <div><label class="label">Protection Class (1-10)</label><input type="number" id="protectionClass" min="1" max="10" placeholder="5"></div>
                </div>
                
                <label class="label">Burglar Alarm</label>
                <select id="burglarAlarm">
                    <option value="">None</option>
                    <option value="Local">Local</option>
                    <option value="Central">Central Station</option>
                    <option value="Direct">Direct to Police/Fire</option>
                </select>
                
                <label class="label">Fire / Smoke Detection</label>
                <select id="fireAlarm">
                    <option value="">None</option>
                    <option value="Local">Local (Battery/Wired)</option>
                    <option value="Central">Central Station</option>
                    <option value="Direct">Direct to Fire Dept.</option>
                </select>
                
                <label class="label">Sprinkler System</label>
                <select id="sprinklers">
                    <option value="">None</option>
                    <option value="Partial">Partial</option>
                    <option value="Full">Full</option>
                </select>

                <label class="label">Smoke Detector</label>
                <select id="smokeDetector">
                    <option value="">None</option>
                    <option value="Local">Local (Battery/Wired)</option>
                    <option value="Central">Central Station</option>
                    <option value="Direct">Direct to Fire Dept.</option>
                </select>
            </div>

            <div class="card">
                <h2>Home Risk Factors</h2>
                <p class="section-subtitle">Help us understand potential risk factors</p>

                <label class="label">Swimming Pool</label>
                <select id="pool">
                    <option value="">Select...</option>
                    <option value="None">None</option>
                    <option value="Above Ground">Above Ground</option>
                    <option value="In Ground">In Ground</option>
                    <option value="In Ground with Slide">In Ground with Slide</option>
                </select>

                <label class="label">Trampoline</label>
                <select id="trampoline">
                    <option value="">Select...</option>
                    <option value="None">None</option>
                    <option value="Yes">Yes</option>
                    <option value="Yes with Safety Net">Yes with Safety Net</option>
                </select>

                <label class="label">Wood Burning Stove</label>
                <select id="woodStove">
                    <option value="">Select...</option>
                    <option value="None">None</option>
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                </select>

                <label class="label">Distance to Tidal Water (Miles)</label>
                <select id="tidalWaterDist">
                    <option value="">N/A</option>
                    <option value="0-.5">0 - 0.5</option>
                    <option value=".5-1">0.5 - 1</option>
                    <option value="1-2">1 - 2</option>
                    <option value="2-5">2 - 5</option>
                    <option value="more than 5">More than 5</option>
                </select>

                <label class="label">Dogs / Pets</label>
                <textarea id="dogInfo" placeholder="Breed, age, behavior history (if applicable)" rows="2"></textarea>

                <label class="label">Business on Property</label>
                <textarea id="businessOnProperty" placeholder="Describe any business operations" rows="2"></textarea>
            </div>

            <div class="card">
                <h2>Home Coverage</h2>
                <p class="section-subtitle">Coverage limits and policy details</p>

                <div class="grid-2-full">
                    <div class="full-span">
                        <label class="label">Policy Type</label>
                        <select id="homePolicyType">
                            <option value="HO3" selected>HO3 - Special Form</option>
                            <option value="HO5">HO5 - Comprehensive</option>
                            <option value="HO6">HO6 - Condo</option>
                            <option value="HO4">HO4 - Renters</option>
                            <option value="DP1">DP1 - Dwelling Fire</option>
                            <option value="DP3">DP3 - Dwelling Special</option>
                        </select>
                    </div>

                    <div class="full-span">
                        <label class="label">Dwelling Coverage (Coverage A)</label>
                        <input type="text" id="dwellingCoverage" placeholder="e.g. 600000" inputmode="numeric">
                    </div>

                    <div>
                        <label class="label">Personal Liability</label>
                        <select id="personalLiability">
                            <option value="">Select...</option>
                            <option value="25000">$25,000</option>
                            <option value="50000">$50,000</option>
                            <option value="100000">$100,000</option>
                            <option value="200000">$200,000</option>
                            <option value="300000">$300,000</option>
                            <option value="400000">$400,000</option>
                            <option value="500000">$500,000</option>
                            <option value="1000000">$1,000,000</option>
                        </select>
                    </div>
                    <div>
                        <label class="label">Medical Payments</label>
                        <select id="medicalPayments">
                            <option value="">Select...</option>
                            <option value="1000">$1,000</option>
                            <option value="2000">$2,000</option>
                            <option value="3000">$3,000</option>
                            <option value="4000">$4,000</option>
                            <option value="5000">$5,000</option>
                        </select>
                    </div>

                    <div>
                        <label class="label">All Perils Deductible</label>
                        <select id="homeDeductible">
                            <option value="">Select...</option>
                            <option value="1/2%">1/2%</option>
                            <option value="1%">1%</option>
                            <option value="100">$100</option>
                            <option value="250">$250</option>
                            <option value="500">$500</option>
                            <option value="750">$750</option>
                            <option value="1000">$1,000</option>
                            <option value="1500">$1,500</option>
                            <option value="2000">$2,000</option>
                            <option value="2500">$2,500</option>
                            <option value="3000">$3,000</option>
                            <option value="4000">$4,000</option>
                            <option value="5000">$5,000</option>
                        </select>
                    </div>
                    <div>
                        <label class="label">Wind / Hail Deductible</label>
                        <select id="windDeductible">
                            <option value="">Same as All Perils</option>
                            <option value="100">$100</option>
                            <option value="250">$250</option>
                            <option value="500">$500</option>
                            <option value="1000">$1,000</option>
                            <option value="1500">$1,500</option>
                            <option value="2000">$2,000</option>
                            <option value="2500">$2,500</option>
                            <option value="5000">$5,000</option>
                            <option value="10000">$10,000</option>
                            <option value="1%">1%</option>
                            <option value="2%">2%</option>
                            <option value="3%">3%</option>
                            <option value="4%">4%</option>
                            <option value="5%">5%</option>
                        </select>
                    </div>

                    <div class="full-span">
                        <label class="label">Mortgagee / Lienholder</label>
                        <input type="text" id="mortgagee" placeholder="Bank name and address">
                    </div>
                </div>
            </div>

            <div class="card">
                <h2>Home Endorsements</h2>
                <p class="section-subtitle">Optional coverages and endorsements</p>

                <!-- ‚îÄ‚îÄ Group 1: Coverage Limit Selectors (2-column grid) ‚îÄ‚îÄ -->
                <div class="grid-2-full">
                    <div>
                        <label class="label">Increased Replacement Cost %</label>
                        <select id="increasedReplacementCost">
                            <option value="">None</option>
                            <option value="125">125%</option>
                            <option value="150">150%</option>
                            <option value="200">200%</option>
                        </select>
                    </div>
                    <div>
                        <label class="label">Ordinance or Law %</label>
                        <select id="ordinanceOrLaw">
                            <option value="">None</option>
                            <option value="10">10%</option>
                            <option value="25">25%</option>
                            <option value="50">50%</option>
                            <option value="75">75%</option>
                            <option value="100">100%</option>
                        </select>
                    </div>
                    <div>
                        <label class="label">Water Backup</label>
                        <select id="waterBackup">
                            <option value="">None</option>
                            <option value="1000">$1,000</option>
                            <option value="2000">$2,000</option>
                            <option value="3000">$3,000</option>
                            <option value="4000">$4,000</option>
                            <option value="5000">$5,000</option>
                            <option value="6000">$6,000</option>
                            <option value="7000">$7,000</option>
                            <option value="8000">$8,000</option>
                            <option value="9000">$9,000</option>
                            <option value="10000">$10,000</option>
                            <option value="15000">$15,000</option>
                            <option value="20000">$20,000</option>
                            <option value="25000">$25,000</option>
                            <option value="50000">$50,000</option>
                        </select>
                    </div>
                    <div>
                        <label class="label">Loss Assessment</label>
                        <select id="lossAssessment">
                            <option value="">None</option>
                            <option value="5000">$5,000</option>
                            <option value="10000">$10,000</option>
                            <option value="25000">$25,000</option>
                            <option value="50000">$50,000</option>
                            <option value="75000">$75,000</option>
                            <option value="100000">$100,000</option>
                        </select>
                    </div>
                    <div>
                        <label class="label">Animal Liability</label>
                        <select id="animalLiability">
                            <option value="">None</option>
                            <option value="25000">$25,000</option>
                            <option value="50000">$50,000</option>
                            <option value="100000">$100,000</option>
                        </select>
                    </div>
                    <div>
                        <label class="label">Theft Deductible</label>
                        <select id="theftDeductible">
                            <option value="">Same as All Perils</option>
                            <option value="500">$500</option>
                            <option value="1500">$1,500</option>
                        </select>
                    </div>
                    <div>
                        <label class="label">Jewelry / Watches / Furs Limit</label>
                        <select id="jewelryLimit">
                            <option value="">Default</option>
                            <option value="2500">$2,500</option>
                            <option value="3000">$3,000</option>
                            <option value="4000">$4,000</option>
                            <option value="5000">$5,000</option>
                        </select>
                    </div>
                    <div>
                        <label class="label">Increased Credit Card Coverage</label>
                        <select id="creditCardCoverage">
                            <option value="">Default</option>
                            <option value="1000">$1,000</option>
                            <option value="2500">$2,500</option>
                            <option value="5000">$5,000</option>
                            <option value="7500">$7,500</option>
                            <option value="10000">$10,000</option>
                        </select>
                    </div>
                    <div class="full-span">
                        <label class="label">Increased Mold Damage</label>
                        <select id="moldDamage">
                            <option value="">Default</option>
                            <option value="25000">$25,000</option>
                            <option value="50000">$50,000</option>
                            <option value="75000">$75,000</option>
                            <option value="100000">$100,000</option>
                        </select>
                    </div>
                </div>

                <!-- ‚îÄ‚îÄ Group 2: Binary Toggles (3-column compact cards) ‚îÄ‚îÄ -->
                <div class="toggle-grid-3">
                    <div class="toggle-card">
                        <label class="label">Equipment Breakdown</label>
                        <input type="hidden" id="equipmentBreakdown" value="">
                        <label class="toggle-switch">
                            <input type="checkbox" data-toggle-field="equipmentBreakdown">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                    <div class="toggle-card">
                        <label class="label">Service Line</label>
                        <input type="hidden" id="serviceLine" value="">
                        <label class="toggle-switch">
                            <input type="checkbox" data-toggle-field="serviceLine">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                    <div class="toggle-card">
                        <label class="label">Earthquake</label>
                        <input type="hidden" id="earthquakeCoverage" value="">
                        <label class="toggle-switch">
                            <input type="checkbox" data-toggle-field="earthquakeCoverage">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                </div>

                <!-- ‚îÄ‚îÄ Earthquake Details (progressive disclosure) ‚îÄ‚îÄ -->
                <div id="earthquakeDetailsWrapper" class="disclosure-hidden" style="margin-top: 12px;">
                    <div class="grid-2-full">
                        <div>
                            <label class="label">Earthquake Zone</label>
                            <select id="earthquakeZone">
                                <option value="">N/A</option>
                                <option value="1">Zone 1</option>
                                <option value="2">Zone 2</option>
                                <option value="3">Zone 3</option>
                                <option value="4">Zone 4</option>
                                <option value="5">Zone 5</option>
                                <option value="6">Zone 6</option>
                                <option value="7">Zone 7</option>
                                <option value="8">Zone 8</option>
                                <option value="9">Zone 9</option>
                            </select>
                        </div>
                        <div>
                            <label class="label">Earthquake Deductible</label>
                            <select id="earthquakeDeductible">
                                <option value="">N/A</option>
                                <option value="5%">5%</option>
                                <option value="10%">10%</option>
                                <option value="15%">15%</option>
                                <option value="20%">20%</option>
                                <option value="25%">25%</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>

            </div> <!-- end .prop-main (left column) -->

            <!-- ‚ïê‚ïê‚ïê RIGHT COLUMN: Sticky Sidebar ‚ïê‚ïê‚ïê -->
            <div class="prop-sidebar">
                <div class="card map-preview-card">
                    <h2>Property Views</h2>
                    <p class="section-subtitle">Street &amp; satellite preview</p>
                    <div class="map-previews" style="grid-template-columns: 1fr;">
                        <div class="map-preview-item">
                            <div class="map-preview-label">Street View</div>
                            <img id="streetViewImg" class="map-preview-img" alt="Street View preview" />
                            <div class="map-preview-actions">
                                <button class="btn-utility" onclick="App.openStreetView()">üö∂ Street View</button>
                            </div>
                        </div>
                        <div class="map-preview-item">
                            <div class="map-preview-label">Satellite View</div>
                            <img id="satelliteViewImg" class="map-preview-img" alt="Satellite preview" />
                            <div class="map-preview-actions">
                                <button class="btn-utility" onclick="App.openGoogleMaps()">üó∫Ô∏è Maps</button>
                                <button class="btn-utility" onclick="App.openGoogleEarth()">üõ∞Ô∏è Earth</button>
                            </div>
                        </div>
                    </div>
                    <div id="mapPreviewHint" class="hint">Enter an address to load previews.</div>
                </div>
            </div> <!-- end .prop-sidebar -->

          </div> <!-- end .prop-layout -->
        </div>

        <!-- STEP 4: VEHICLE & DRIVER INFO -->
        <div id="step-4" class="step hidden">
            <div class="card">
                <h2>Drivers</h2>
                <p class="section-subtitle">Add all household drivers (you can add more later)</p>
                
                <div id="driversList"></div>
                
                <button class="btn btn-secondary" style="margin-top: 12px;" onclick="App.addDriver()">+ Add Driver</button>
            </div>

            <div class="card">
                <h2>Vehicles</h2>
                <p class="section-subtitle">Add all vehicles to insure</p>
                
                <div id="vehiclesList"></div>
                
                <button class="btn btn-secondary" style="margin-top: 12px;" onclick="App.addVehicle()">+ Add Vehicle</button>
            </div>

            <div class="card">
                <h2>Driving History</h2>
                <p class="section-subtitle">Accidents, violations, and discounts</p>

                <label class="label">Accidents (Last 5 Years)</label>
                <textarea id="accidents" placeholder="Date, description, claim amount" rows="2"></textarea>

                <label class="label">Violations / Tickets (Last 3 Years)</label>
                <textarea id="violations" placeholder="Date, type of violation" rows="2"></textarea>

                <label class="label">Student GPA (if applicable)</label>
                <input type="text" id="studentGPA" placeholder="3.5">
            </div>

            <div class="card">
                <h2>Auto Coverage</h2>
                <p class="section-subtitle">Current auto insurance details</p>

                <div class="grid-2">
                    <div>
                        <label class="label">Auto Policy Type</label>
                        <select id="autoPolicyType">
                            <option value="Standard">Standard</option>
                            <option value="NonOwners">Non-Owners</option>
                            <option value="BroadForm">Broad Form</option>
                        </select>
                    </div>
                    <div>
                        <label class="label">Residence Is</label>
                        <select id="residenceIs">
                            <option value="">Select...</option>
                            <option value="Home (owned)">Home (Owned)</option>
                            <option value="Condo (owned)">Condo (Owned)</option>
                            <option value="Apartment">Apartment</option>
                            <option value="Rental Home/Condo">Rental Home / Condo</option>
                            <option value="Mobile Home">Mobile Home</option>
                            <option value="Live With Parents">Live With Parents</option>
                            <option value="Other">Other</option>
                        </select>
                    </div>
                </div>

                <div class="grid-2">
                    <div>
                        <label class="label">Bodily Injury Limits (BI)</label>
                        <select id="liabilityLimits">
                            <option value="">Select...</option>
                            <option value="State Minimum">State Minimum</option>
                            <option value="25/50">25/50 ($25k/$50k)</option>
                            <option value="50/50">50/50 ($50k/$50k)</option>
                            <option value="50/100">50/100 ($50k/$100k)</option>
                            <option value="100/100">100/100 ($100k/$100k)</option>
                            <option value="100/300">100/300 ($100k/$300k)</option>
                            <option value="250/500">250/500 ($250k/$500k)</option>
                            <option value="300/300">300/300 ($300k/$300k)</option>
                            <option value="500/500">500/500 ($500k/$500k)</option>
                            <option value="1000/1000">1000/1000 ($1M/$1M)</option>
                            <option value="55 CSL">55 CSL</option>
                            <option value="100 CSL">100 CSL</option>
                            <option value="300 CSL">300 CSL</option>
                            <option value="500 CSL">500 CSL</option>
                        </select>
                    </div>
                    <div>
                        <label class="label">Property Damage Limit (PD)</label>
                        <select id="pdLimit">
                            <option value="">Select...</option>
                            <option value="State Minimum">State Minimum</option>
                            <option value="10000">$10,000</option>
                            <option value="15000">$15,000</option>
                            <option value="25000">$25,000</option>
                            <option value="50000">$50,000</option>
                            <option value="100000">$100,000</option>
                            <option value="250000">$250,000</option>
                            <option value="500000">$500,000</option>
                        </select>
                    </div>
                </div>

                <div class="grid-2">
                    <div>
                        <label class="label">Uninsured Motorist (UM)</label>
                        <select id="umLimits">
                            <option value="">Select...</option>
                            <option value="No Coverage">No Coverage</option>
                            <option value="State Minimum">State Minimum</option>
                            <option value="25/50">25/50</option>
                            <option value="50/50">50/50</option>
                            <option value="50/100">50/100</option>
                            <option value="100/100">100/100</option>
                            <option value="100/300">100/300</option>
                            <option value="250/500">250/500</option>
                            <option value="300/300">300/300</option>
                            <option value="500/500">500/500</option>
                            <option value="1000/1000">1000/1000</option>
                        </select>
                    </div>
                    <div>
                        <label class="label">Underinsured Motorist (UIM)</label>
                        <select id="uimLimits">
                            <option value="">Select...</option>
                            <option value="No Coverage">No Coverage</option>
                            <option value="State Minimum">State Minimum</option>
                            <option value="25/50">25/50</option>
                            <option value="50/50">50/50</option>
                            <option value="50/100">50/100</option>
                            <option value="100/100">100/100</option>
                            <option value="100/300">100/300</option>
                            <option value="250/500">250/500</option>
                            <option value="300/300">300/300</option>
                            <option value="500/500">500/500</option>
                            <option value="1000/1000">1000/1000</option>
                        </select>
                    </div>
                </div>

                <div class="grid-2">
                    <div>
                        <label class="label">Comprehensive Deductible</label>
                        <select id="compDeductible">
                            <option value="">Select...</option>
                            <option value="No Coverage">No Coverage</option>
                            <option value="0">$0 (Full Glass)</option>
                            <option value="50">$50</option>
                            <option value="100">$100</option>
                            <option value="200">$200</option>
                            <option value="250">$250</option>
                            <option value="500">$500</option>
                            <option value="1000">$1,000</option>
                            <option value="2000">$2,000</option>
                            <option value="2500">$2,500</option>
                        </select>
                    </div>
                    <div>
                        <label class="label">Collision Deductible</label>
                        <select id="autoDeductible">
                            <option value="">Select...</option>
                            <option value="No Coverage">No Coverage</option>
                            <option value="0">$0</option>
                            <option value="50">$50</option>
                            <option value="100">$100</option>
                            <option value="200">$200</option>
                            <option value="250">$250</option>
                            <option value="500">$500</option>
                            <option value="1000">$1,000</option>
                            <option value="2000">$2,000</option>
                            <option value="2500">$2,500</option>
                        </select>
                    </div>
                </div>

                <div class="grid-2">
                    <div>
                        <label class="label">Medical Payments</label>
                        <select id="medPayments">
                            <option value="">Select...</option>
                            <option value="No Coverage">No Coverage</option>
                            <option value="500">$500</option>
                            <option value="1000">$1,000</option>
                            <option value="2000">$2,000</option>
                            <option value="2500">$2,500</option>
                            <option value="5000">$5,000</option>
                            <option value="10000">$10,000</option>
                            <option value="25000">$25,000</option>
                            <option value="50000">$50,000</option>
                            <option value="100000">$100,000</option>
                        </select>
                    </div>
                    <div>
                        <label class="label">UM Property Damage</label>
                        <select id="umpdLimit">
                            <option value="">Select...</option>
                            <option value="No Coverage">No Coverage</option>
                            <option value="State Minimum">State Minimum</option>
                            <option value="10000">$10,000</option>
                            <option value="25000">$25,000</option>
                            <option value="50000">$50,000</option>
                            <option value="100000">$100,000</option>
                        </select>
                    </div>
                </div>

                <div class="grid-2">
                    <div>
                        <label class="label">Rental Reimbursement</label>
                        <select id="rentalDeductible">
                            <option value="">Select...</option>
                            <option value="No Coverage">No Coverage</option>
                            <option value="20/600">$20/day, $600 max</option>
                            <option value="30/900">$30/day, $900 max</option>
                            <option value="40/1200">$40/day, $1200 max</option>
                            <option value="50/1500">$50/day, $1500 max</option>
                            <option value="75/2250">$75/day, $2250 max</option>
                        </select>
                    </div>
                    <div>
                        <label class="label">Towing & Labor</label>
                        <select id="towingDeductible">
                            <option value="">Select...</option>
                            <option value="No Coverage">No Coverage</option>
                            <option value="50">$50</option>
                            <option value="75">$75</option>
                            <option value="100">$100</option>
                            <option value="200">$200</option>
                        </select>
                    </div>
                </div>
            </div>
        </div>

        <!-- STEP 5: INSURANCE HISTORY & ADDITIONAL INFO -->
        <div id="step-5" class="step hidden">
            <div class="card">
                <h2>Policy Details</h2>
                <p class="section-subtitle">Requested policy information</p>

                <div class="grid-2">
                    <div>
                        <label class="label">Requested Policy Term</label>
                        <select id="policyTerm">
                            <option value="">Select...</option>
                            <option value="6 Month">6 Month</option>
                            <option value="12 Month">12 Month</option>
                        </select>
                    </div>
                    <div>
                        <label class="label">Requested Effective Date</label>
                        <input type="date" id="effectiveDate">
                    </div>
                </div>
            </div>

            <!-- Home Insurance History (visible for home/both) -->
            <div class="card qtype-home-prior" id="homePriorCard">
                <h2>Home Insurance History</h2>
                <p class="section-subtitle">Your current homeowners / property coverage</p>

                <div class="grid-2">
                    <div>
                        <label class="label">Prior Home Carrier</label>
                        <select id="homePriorCarrier">
                            <option value="">Select carrier...</option>
                        </select>
                    </div>
                    <div>
                        <label class="label">Prior Home Policy Term</label>
                        <select id="homePriorPolicyTerm">
                            <option value="">Select...</option>
                            <option value="6 Month">6 Month</option>
                            <option value="12 Month">12 Month</option>
                        </select>
                    </div>
                </div>

                <div class="grid-2">
                    <div>
                        <label class="label">Prior Liability Level</label>
                        <select id="homePriorLiability">
                            <option value="">Select...</option>
                            <option value="Greater than $300,000">Greater than $300,000</option>
                            <option value="$300,000">$300,000</option>
                            <option value="Less than $300,000">Less than $300,000</option>
                            <option value="First Time Home Buyer">First Time Home Buyer</option>
                            <option value="Lapse in Coverage (30 days or less)">Lapse in Coverage (30 days or less)</option>
                            <option value="No Prior or Lapse Greater Than 30 Days">No Prior or Lapse &gt; 30 Days</option>
                        </select>
                    </div>
                    <div>
                        <label class="label">Years with Prior Carrier</label>
                        <select id="homePriorYears">
                            <option value="">Select...</option>
                            <option value="0">0</option>
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5</option>
                            <option value="6">6</option>
                            <option value="7">7</option>
                            <option value="8">8</option>
                            <option value="9">9</option>
                            <option value="10">10</option>
                            <option value="11">11</option>
                            <option value="12">12</option>
                            <option value="13">13</option>
                            <option value="14">14</option>
                            <option value="15">15</option>
                            <option value="More than 15">More than 15</option>
                        </select>
                    </div>
                </div>

                <div class="grid-2">
                    <div><label class="label">Prior Home Policy Expiration</label><input type="date" id="homePriorExp"></div>
                </div>
            </div>

            <!-- Auto Insurance History (visible for auto/both) -->
            <div class="card qtype-auto-prior" id="autoPriorCard">
                <h2>Auto Insurance History</h2>
                <p class="section-subtitle">Your current auto coverage</p>

                <div class="grid-2">
                    <div>
                        <label class="label">Prior Auto Carrier</label>
                        <select id="priorCarrier">
                            <option value="">Select carrier...</option>
                        </select>
                        <label class="same-carrier-row">
                            <input type="checkbox" id="sameAsHomeCarrier" onchange="App.handleSameCarrier()">
                            <span>Same as Home Carrier</span>
                        </label>
                    </div>
                    <div>
                        <label class="label">Prior Auto Policy Term</label>
                        <select id="priorPolicyTerm">
                            <option value="">Select...</option>
                            <option value="6 Month">6 Month</option>
                            <option value="12 Month">12 Month</option>
                        </select>
                    </div>
                </div>

                <div class="grid-2">
                    <div>
                        <label class="label">Prior Liability Limits</label>
                        <select id="priorLiabilityLimits">
                            <option value="">Select...</option>
                            <option value="State Minimum">State Minimum</option>
                            <option value="25/50">25/50</option>
                            <option value="50/50">50/50</option>
                            <option value="50/100">50/100</option>
                            <option value="100/100">100/100</option>
                            <option value="100/300">100/300</option>
                            <option value="250/500">250/500</option>
                            <option value="300/300">300/300</option>
                            <option value="500/500">500/500</option>
                            <option value="1000/1000">1000/1000</option>
                            <option value="55CSL">55 CSL</option>
                            <option value="100CSL">100 CSL</option>
                            <option value="300CSL">300 CSL</option>
                            <option value="500CSL">500 CSL</option>
                        </select>
                    </div>
                    <div>
                        <label class="label">Years with Prior Carrier</label>
                        <select id="priorYears">
                            <option value="">Select...</option>
                            <option value="0">0</option>
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5</option>
                            <option value="6">6</option>
                            <option value="7">7</option>
                            <option value="8">8</option>
                            <option value="9">9</option>
                            <option value="10">10</option>
                            <option value="11">11</option>
                            <option value="12">12</option>
                            <option value="13">13</option>
                            <option value="14">14</option>
                            <option value="15">15</option>
                            <option value="More than 15">More than 15</option>
                        </select>
                    </div>
                </div>

                <div class="grid-2">
                    <div>
                        <label class="label">Years with Continuous Coverage</label>
                        <select id="continuousCoverage">
                            <option value="">Select...</option>
                            <option value="0">0</option>
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5</option>
                            <option value="6">6</option>
                            <option value="7">7</option>
                            <option value="8">8</option>
                            <option value="9">9</option>
                            <option value="10">10</option>
                            <option value="11">11</option>
                            <option value="12">12</option>
                            <option value="13">13</option>
                            <option value="14">14</option>
                            <option value="15">15</option>
                            <option value="More than 15">More than 15</option>
                        </select>
                    </div>
                    <div><label class="label">Prior Auto Policy Expiration</label><input type="date" id="priorExp"></div>
                </div>
            </div>

            <div class="card">
                <h2>Additional Information</h2>
                <p class="section-subtitle">Help us serve you better</p>

                <label class="label">Additional Insured Parties</label>
                <textarea id="additionalInsureds" placeholder="Names and relationships" rows="2"></textarea>

                <label class="label">Best Time to Contact</label>
                <select id="contactTime">
                    <option value="">Select...</option>
                    <option value="Morning">Morning</option>
                    <option value="Afternoon">Afternoon</option>
                    <option value="Evening">Evening</option>
                    <option value="Anytime">Anytime</option>
                </select>

                <label class="label">Preferred Contact Method</label>
                <select id="contactMethod">
                    <option value="">Select...</option>
                    <option value="Mobile Phone">Mobile Phone</option>
                    <option value="Email">Email</option>
                </select>

                <label class="label">How did you hear about us?</label>
                <select id="referralSource">
                    <option value="">Select...</option>
                    <option value="Google Search">Google Search</option>
                    <option value="Social Media">Social Media</option>
                    <option value="Referral">Referral from Friend/Family</option>
                    <option value="Advertisement">Advertisement</option>
                    <option value="Other">Other</option>
                </select>

                <div class="consent-row">
                    <label class="checkbox-row">
                        <input type="checkbox" id="tcpaConsent">
                        <span>I consent to receive communications via phone, text, and email regarding insurance quotes and services.</span>
                    </label>
                </div>
            </div>
        </div>

        <!-- Shared datalist for Prior Carrier fields (auto + home) -->
        <datalist id="carrierList">
            <option value="Other Standard">
            <option value="Other Non-Standard">
            <option value="No Prior Insurance">
            <option value="1st Auto">
            <option value="21st Century">
            <option value="A.Central">
            <option value="AAA">
            <option value="AARP">
            <option value="Acadia">
            <option value="Acceptance Insurance">
            <option value="Access General">
            <option value="Ace">
            <option value="Acuity">
            <option value="Adirondack Ins Exchange">
            <option value="Aegis">
            <option value="Affirmative">
            <option value="Ag Workers Mutual Auto">
            <option value="AIC">
            <option value="AIG">
            <option value="Alert Auto Insurance Company">
            <option value="Alfa Alliance">
            <option value="Alinsco">
            <option value="Allied Trust Insurance Company">
            <option value="Allied">
            <option value="Allstate">
            <option value="America First">
            <option value="American Commerce">
            <option value="American Family">
            <option value="American Freedom Insurance Company">
            <option value="American National">
            <option value="Amerisure">
            <option value="Amica">
            <option value="AmShield">
            <option value="AmWINS Star">
            <option value="Anchor General">
            <option value="Arrowhead Everest">
            <option value="Arrowhead">
            <option value="ASI Lloyds">
            <option value="ASI Select Auto Insurance Corp">
            <option value="Aspen">
            <option value="Aspire">
            <option value="AssuranceAmerica">
            <option value="Atlantic Mutual">
            <option value="Austin Mutual">
            <option value="Autoone">
            <option value="Auto-Owners">
            <option value="AutoTex">
            <option value="Badger Mutual">
            <option value="Balboa">
            <option value="Bankers">
            <option value="Beacon National">
            <option value="Bear River Mutual">
            <option value="Brethern Mutual">
            <option value="Bristol West">
            <option value="Buckeye">
            <option value="California Casualty">
            <option value="Cameron Mutual">
            <option value="Capital Insurance Group">
            <option value="Capitol Insurance Company">
            <option value="Casualty Underwriters Insurance Company">
            <option value="Celina">
            <option value="Centennial">
            <option value="Central Mutual of OH">
            <option value="Century National">
            <option value="Charter">
            <option value="Chubb">
            <option value="Cincinnati Casualty">
            <option value="Cincinnati Insurance">
            <option value="Citizens">
            <option value="Clearcover">
            <option value="CNA">
            <option value="Colonial Penn">
            <option value="Colorado Casualty">
            <option value="Columbia">
            <option value="Commerce West">
            <option value="Commonwealth">
            <option value="Concord Group Insurance">
            <option value="Connect Banner">
            <option value="Constitutional Casualty">
            <option value="Consumers">
            <option value="Cornerstone">
            <option value="Country Insurance">
            <option value="Countryway Insurance">
            <option value="Countrywide">
            <option value="Cover Insurance">
            <option value="CSE">
            <option value="Cumberland">
            <option value="Dairyland">
            <option value="Deerbrook">
            <option value="Delta Lloyds Insurance Company">
            <option value="Depositors">
            <option value="Direct General">
            <option value="Direct">
            <option value="Discovery">
            <option value="Donegal">
            <option value="Drive">
            <option value="Electric">
            <option value="Elephant Insurance">
            <option value="Embark General">
            <option value="EMC">
            <option value="Empower">
            <option value="Encompass">
            <option value="Encova Exceed">
            <option value="Enumclaw Insurance">
            <option value="Erie">
            <option value="Esurance">
            <option value="Eveready">
            <option value="Explorer">
            <option value="Farm Bureau">
            <option value="Farmers">
            <option value="Federated">
            <option value="Fidelity">
            <option value="Financial Indemnity">
            <option value="Firemans Fund">
            <option value="First Acceptance">
            <option value="First American">
            <option value="First Auto">
            <option value="First Chicago">
            <option value="First Connect">
            <option value="Fitchburg Mutual">
            <option value="Flagship Insurance">
            <option value="Foremost">
            <option value="Founders">
            <option value="Frankenmuth">
            <option value="Fred Loya">
            <option value="Fremont Insurance">
            <option value="GAINSCO Auto Insurance">
            <option value="Gateway">
            <option value="Geico">
            <option value="General Casualty">
            <option value="Germania Insurance">
            <option value="Germantown Mutual">
            <option value="GMAC">
            <option value="Goodville Mutual">
            <option value="Grange Insurance Association">
            <option value="Grange">
            <option value="GRE/Go America">
            <option value="Great American">
            <option value="Grinnell">
            <option value="Guide One">
            <option value="Hallmark Insurance Company">
            <option value="Hanover">
            <option value="Harbor">
            <option value="Harleysville">
            <option value="Hartford OMNI">
            <option value="Hartford">
            <option value="Hastings Mutual">
            <option value="Haulers Insurance Company">
            <option value="Hawkeye Security">
            <option value="HDI">
            <option value="Hochheim Prairie Insurance">
            <option value="Horace Mann">
            <option value="Houston General">
            <option value="IFA">
            <option value="Imperial Casualty">
            <option value="IMT Ins">
            <option value="Indiana Farmers">
            <option value="Indiana">
            <option value="Infinity">
            <option value="Insuremax">
            <option value="Insurequest">
            <option value="Integon">
            <option value="Integrity">
            <option value="Iowa Mutual Insurance Company">
            <option value="Kemper Specialty">
            <option value="Kemper">
            <option value="Kingsway">
            <option value="Legacy - Arizona Auto Ins. Co">
            <option value="LeMars Insurance">
            <option value="Liberty Mutual">
            <option value="Liberty Northwest">
            <option value="Madison Mutual Insurance Company">
            <option value="Maidstone Insurance">
            <option value="MAIF">
            <option value="Main Street America">
            <option value="Mapfre">
            <option value="Markel">
            <option value="Maryland Auto Insurance">
            <option value="Mendakota">
            <option value="Mendota">
            <option value="Merchants Group">
            <option value="Mercury">
            <option value="MetLife">
            <option value="Metropolitan">
            <option value="Michigan Insurance Company">
            <option value="Michigan Millers Mutual Insurance Company">
            <option value="Mid-Continent">
            <option value="Midwestern Indemnity">
            <option value="Mile Auto">
            <option value="MMG Insurance Company">
            <option value="Montgomery">
            <option value="Motor Club Insurance Company">
            <option value="Motorists Mutual">
            <option value="MSA">
            <option value="Mt. Washington">
            <option value="Mutual Benefit">
            <option value="Mutual of Enumclaw">
            <option value="National General">
            <option value="National Lloyds Insurance Company">
            <option value="Nationwide">
            <option value="New York Central Mutual">
            <option value="NJ Manufacturers">
            <option value="NJ Skylands">
            <option value="NLC Insurance Companies">
            <option value="Nodak Mutual">
            <option value="Northern Neck Insurance Company">
            <option value="Northstar">
            <option value="NYAIP">
            <option value="NYCM Standard">
            <option value="Occidental">
            <option value="Ocean Harbor">
            <option value="Ohio Casualty">
            <option value="Ohio Mutual">
            <option value="Omaha P/C">
            <option value="Omni Insurance Co">
            <option value="One Beacon">
            <option value="Oregon Mutual">
            <option value="Palisades">
            <option value="Partners Mutual Insurance">
            <option value="Patriot">
            <option value="Patrons Oxford">
            <option value="Peerless/Montgomery">
            <option value="Pekin">
            <option value="Pemco">
            <option value="Peninsula Insurance Companies">
            <option value="Penn National">
            <option value="Personal Service Insurance">
            <option value="Phoenix Indemnity">
            <option value="Pioneer State Mutual">
            <option value="Plymouth Rock">
            <option value="Preferred Mutual">
            <option value="Proformance">
            <option value="Progressive">
            <option value="Providence Mutual Fire Insurance Company">
            <option value="Prudential">
            <option value="QBE">
            <option value="Quincy Mutual">
            <option value="RAM Mutual Insurance Company">
            <option value="Republic">
            <option value="Response">
            <option value="Rockford Mutual">
            <option value="Rockingham Casualty Company">
            <option value="Royal and Sun Alliance">
            <option value="Safe Auto">
            <option value="Safeco">
            <option value="Safety Insurance Company">
            <option value="Safeway">
            <option value="Sagamore">
            <option value="SECURA">
            <option value="Selective">
            <option value="Sentry Ins">
            <option value="Sheboygan Falls Insurance">
            <option value="Shelter Insurance">
            <option value="Southern County">
            <option value="Southern Mutual">
            <option value="Southern Trust">
            <option value="St. Paul/Travelers">
            <option value="Standard Mutual">
            <option value="Star Casualty">
            <option value="State Auto">
            <option value="State Farm">
            <option value="StillWater">
            <option value="Stonegate">
            <option value="Sublimity Insurance Company">
            <option value="Sun Coast Platinum">
            <option value="Texas Ranger MGA">
            <option value="The General">
            <option value="Titan">
            <option value="Topa">
            <option value="Tower">
            <option value="Travelers">
            <option value="TWFG">
            <option value="Unigard">
            <option value="United Automobile">
            <option value="United Fire and Casualty">
            <option value="United Heritage Property and Casualty Company">
            <option value="United Home">
            <option value="Unitrin">
            <option value="Universal">
            <option value="USAA">
            <option value="Utica National">
            <option value="Victoria">
            <option value="Wadena Insurance Company">
            <option value="Wayne Mutual Insurance Company">
            <option value="West Bend">
            <option value="Western National">
            <option value="Western Reserve Group">
            <option value="Westfield">
            <option value="White Mountains">
            <option value="Wilshire">
            <option value="Wilson Mutual">
            <option value="Wind Haven">
            <option value="Windsor">
            <option value="Wisconsin Mutual">
            <option value="Wolverine Mutual Insurance Company">
            <option value="Workmens Auto Insurance Company">
            <option value="Worth Casualty Insurance Company">
            <option value="Zurich">
        </datalist>

        <!-- STEP 6: REVIEW & EXPORT -->
        <div id="step-6" class="step hidden">
            <div class="card">
                <h2>‚úì Application Complete</h2>
                <p class="section-subtitle">Export this client's data or restore a previous client</p>
            </div>

            <!-- Export Actions -->
            <div class="card export-card hero-export" id="ezlynx-export-card">
                <h3>Ready to Export?</h3>
                <p class="hero-desc">Send your intake data straight into EZLynx, download a PDF summary, or export to HawkSoft.</p>
                <button class="hero-btn" onclick="App.launchEZLynxFromExport()">‚ö° Auto-Fill EZLynx</button>
                <p class="hero-hint">Opens EZLynx and fills the new-applicant form automatically</p>
            </div>

            <!-- Prominent export buttons row -->
            <div class="export-btn-row">
                <button class="export-action-btn pdf-btn" onclick="App.exportPDF()">
                    <span class="export-action-icon">üìÑ</span>
                    <span class="export-action-label">Download PDF</span>
                </button>
                <button class="export-action-btn hawksoft-btn" onclick="App.navigateTo('hawksoft')">
                    <span class="export-action-icon">üì§</span>
                    <span class="export-action-label">HawkSoft Export</span>
                </button>
            </div>

            <!-- Client History (auto-saved) -->
            <div class="card export-card">
                <div class="ch-header">
                    <h3 style="margin:0;">üë§ Client History</h3>
                </div>
                <p class="section-subtitle" style="margin-bottom:12px;">Clients are saved automatically ‚Äî restore any previous client instantly</p>
                <div id="clientHistoryList"></div>
            </div>

            <!-- Export History -->
            <div class="card export-card">
                <details id="exportHistoryDetails">
                    <summary class="export-summary" onclick="App.loadExportHistory()">
                        <span>üìã Export History</span>
                    </summary>
                    <div id="exportHistoryList" style="margin-top:12px;font-size:13px;color:var(--text-secondary);">
                        <p>Loading...</p>
                    </div>
                </details>
            </div>
        </div>
    </main>

    <!-- Data Preview Modal Container -->
    <div id="modalContainer"></div>

    <footer>
        <button id="btnBack" class="btn btn-step-back" onclick="App.prev()">‚Üê Previous Step</button>
        <button id="btnNext" class="btn btn-primary" onclick="App.next()">Next</button>
    </footer>

    <div id="toast" class="toast">Message</div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <script>if(window.pdfjsLib){pdfjsLib.GlobalWorkerOptions.workerSrc='https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';}</script>
    <script>
        // Load Google Places API dynamically with key from server or environment (optional - form works without it)
        (async function loadPlacesAPI() {
            try {
                let apiKey = null;
                
                // Try fetching from server endpoint first (Vercel production)
                try {
                    const res = await (typeof Auth !== 'undefined' ? Auth.apiFetch('/api/config?type=keys') : fetch('/api/config?type=keys'));
                    if (res.ok) {
                        const data = await res.json();
                        apiKey = data.apiKey;
                    }
                } catch (e) {
                    // Server endpoint not available, try alternative methods
                }
                
                // If no key from server, try checking window for injected key
                if (!apiKey && window.__PLACES_API_KEY__) {
                    apiKey = window.__PLACES_API_KEY__;
                }
                
                // If still no key, check if it was passed as query parameter (local dev)
                if (!apiKey && window.location.search) {
                    const params = new URLSearchParams(window.location.search);
                    apiKey = params.get('placesKey');
                }
                
                if (!apiKey) {
                    console.info('‚ÑπÔ∏è Google Places API not configured - address autocomplete disabled. For local dev, set PLACES_API_KEY env var or add ?placesKey=... to URL');
                    return;
                }
                
                const script = document.createElement('script');
                script.src = `https://maps.googleapis.com/maps/api/js?key=${apiKey}&libraries=places&callback=initPlaces`;
                script.async = true;
                script.defer = true;
                script.onerror = () => console.warn('‚ö†Ô∏è Places API script failed to load - address autocomplete disabled');
                document.head.appendChild(script);
                console.info('‚úì Places API loaded');
            } catch (err) {
                console.warn('‚ÑπÔ∏è Places API not available:', err.message);
            }
        })();
    </script>
    <script src="js/crypto-helper.js"></script>
    <script>
        const App = {
            data: {},
            step: 0,
            flow: [],
            storageKey: 'altech_v6',
            quotesKey: 'altech_v6_quotes',
            docIntelKey: 'altech_v6_docintel',
            scanFiles: [],
            extractedData: null,
            encryptionEnabled: true, // Toggle encryption on/off
            drivers: [], // Array of driver objects
            vehicles: [], // Array of vehicle objects
            selectedQuoteIds: new Set(),
            docIntelFiles: [],
            docIntelResults: null,
            initialDlScan: null,
            mapApiKey: null,
            mapPreviewCache: {},
            mapPreviewTimer: null,
            saveTimeout: null,
            saveToken: 0,
            
            workflows: {
                home: ['step-0', 'step-1', 'step-2', 'step-3', 'step-5', 'step-6'],
                auto: ['step-0', 'step-1', 'step-2', 'step-4', 'step-5', 'step-6'],
                both: ['step-0', 'step-1', 'step-2', 'step-3', 'step-4', 'step-5', 'step-6']
            },

            toolNames: {
                quoting: 'Personal Intake',
                coi: 'COI Generator',
                prospect: 'Prospect Investigator',
                compliance: 'CGL Compliance',
                qna: 'Policy Q&A',
                email: 'Email Composer',
                quickref: 'Quick Reference',
                accounting: 'Accounting Export',
                ezlynx: 'EZLynx Quoter',
                quotecompare: 'Quote Compare'
            },

            // Config-driven tool registry ‚Äî single source of truth for landing page,
            // navigation, breadcrumbs, and init logic. Add/remove/reorder tools here.
            toolConfig: [
                // ‚îÄ‚îÄ Quoting & Sales ‚îÄ‚îÄ
                { key: 'quoting',      icon: 'üè†', color: 'icon-blue',    title: 'Personal Lines',  name: 'Personal Intake',       containerId: 'quotingTool',      category: 'quoting' },
                { key: 'qna',          icon: 'üí¨', color: 'icon-rose',    title: 'Policy Q&A',      name: 'Policy Q&A',            containerId: 'qnaTool',          initModule: 'PolicyQA',          htmlFile: 'plugins/qna.html',         category: 'quoting' },
                { key: 'quotecompare', icon: '‚öñÔ∏è', color: 'icon-emerald', title: 'Quote Compare',   name: 'Quote Compare',          containerId: 'quoteCompareTool', initModule: 'QuoteCompare',      htmlFile: 'plugins/quotecompare.html', category: 'quoting' },
                // ‚îÄ‚îÄ Documents & Compliance ‚îÄ‚îÄ
                { key: 'coi',          icon: 'üìã', color: 'icon-teal',    title: 'COI Generator',   name: 'COI Generator',          containerId: 'coiTool',          initModule: 'COI',               htmlFile: 'plugins/coi.html',         category: 'docs' },
                { key: 'compliance',   icon: 'üõ°Ô∏è', color: 'icon-indigo',  title: 'CGL & Bonds',     name: 'CGL Compliance',         containerId: 'complianceTool',   initModule: 'ComplianceDashboard', badge: 'cglBadge', htmlFile: 'plugins/compliance.html', category: 'docs' },
                { key: 'reminders',    icon: '‚è∞', color: 'icon-orange',  title: 'Reminders',       name: 'Task Reminders',         containerId: 'remindersTool',    initModule: 'Reminders',           badge: 'remindersBadge', htmlFile: 'plugins/reminders.html', category: 'docs' },
                // ‚îÄ‚îÄ Operations ‚îÄ‚îÄ
                { key: 'prospect',     icon: 'üîç', color: 'icon-amber',   title: 'Prospect Intel',  name: 'Prospect Investigator',  containerId: 'prospectTool',     initModule: 'ProspectInvestigator', htmlFile: 'plugins/prospect.html', category: 'ops' },
                { key: 'email',        icon: '‚úâÔ∏è', color: 'icon-violet',  title: 'Email Composer',  name: 'Email Composer',         containerId: 'emailTool',        initModule: 'EmailComposer',     htmlFile: 'plugins/email.html',       category: 'ops' },
                { key: 'accounting',   icon: 'üí∞', color: 'icon-amber',   title: 'Accounting',      name: 'Accounting Export',      containerId: 'accountingTool',   initModule: 'AccountingExport',  htmlFile: 'plugins/accounting.html',  category: 'ops' },
                { key: 'hawksoft',     icon: 'üì§', color: 'icon-blue',    title: 'HawkSoft Export', name: 'HawkSoft Export',        containerId: 'hawksoftTool',     initModule: 'HawkSoftExport',    htmlFile: 'plugins/hawksoft.html',    category: 'ops' },
                { key: 'quickref',     icon: 'üìñ', color: 'icon-teal',    title: 'Quick Reference', name: 'Quick Reference',        containerId: 'quickrefTool',     initModule: 'QuickRef',          htmlFile: 'plugins/quickref.html',    category: 'ops' },
                { key: 'vindecoder',   icon: 'üöó', color: 'icon-emerald', title: 'VIN Decoder',     name: 'VIN Decoder',            containerId: 'vinDecoderTool',   initModule: 'VinDecoder',        htmlFile: 'plugins/vin-decoder.html', category: 'ops' },
                // ‚îÄ‚îÄ Hidden / internal ‚îÄ‚îÄ
                { key: 'ezlynx',       icon: 'üìä', color: 'icon-blue',    title: 'EZLynx Quoter',   name: 'EZLynx Quoter',          containerId: 'ezlynxTool',       initModule: 'EZLynxTool',        htmlFile: 'plugins/ezlynx.html',     hidden: true },
                // ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                // ‚îÇ  ADD NEW TOOLS HERE                                        ‚îÇ
                // ‚îÇ  Copy a line above and set: key, icon, color, title,    ‚îÇ
                // ‚îÇ  name, containerId, initModule, category                ‚îÇ
                // ‚îÇ  Categories: 'quoting' | 'docs' | 'ops' | 'ref'        ‚îÇ
                // ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
            ],

            stepTitles: {
                'step-0': 'Policy Scan',
                'step-1': 'Personal Information',
                'step-2': 'Coverage Type',
                'step-3': 'Property Details',
                'step-4': 'Vehicle & Driver Info',
                'step-5': 'Risk Factors & Additional Info',
                'step-6': 'Review & Export'
            },
        };

        // Expose App globally for testing and external tool access
        window.App = App;
    </script>

    <!-- App modules (extracted from inline script - Phase 2 decomposition) -->
    <!-- Order matters: core first (init, navigation, save/load), then features -->
    <script src="js/app-core.js"></script>
    <script src="js/app-scan.js"></script>
    <script src="js/app-property.js"></script>
    <script src="js/app-vehicles.js"></script>
    <script src="js/app-popups.js"></script>
    <script src="js/app-export.js"></script>
    <script src="js/app-quotes.js"></script>

    <script>
        window.initPlaces = () => App.initPlaces();

        // ‚îÄ‚îÄ Global Error Boundaries ‚îÄ‚îÄ
        window.addEventListener('unhandledrejection', (e) => {
            console.error('[Unhandled Rejection]', e.reason);
            if (typeof App !== 'undefined' && App.toast) {
                App.toast(`Unexpected error: ${e.reason?.message || 'Something went wrong'}`, { type: 'error', duration: 4000 });
            }
        });
        window.addEventListener('error', (e) => {
            // Ignore script-load errors (have their own handlers) and ResizeObserver
            if (e.message === 'ResizeObserver loop limit exceeded') return;
            if (e.message?.includes('ResizeObserver loop')) return;
            console.error('[Global Error]', e.message, e.filename, e.lineno);
        });

        // ‚îÄ‚îÄ ServiceWorker Registration (offline app shell) ‚îÄ‚îÄ
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('/sw.js').then((reg) => {
                console.log('[SW] Registered, scope:', reg.scope);
            }).catch((err) => {
                console.warn('[SW] Registration failed:', err.message);
            });
        }

        window.onload = async () => {
            // Apply dark mode preference FIRST ‚Äî before any tool rendering
            App.loadDarkMode();

            // Initialize cloud sync (non-blocking)
            if (typeof FirebaseConfig !== 'undefined' && FirebaseConfig.sdkLoaded) {
                FirebaseConfig.init().then(() => {
                    if (typeof Auth !== 'undefined') Auth.init();
                }).catch(e => console.warn('[App] Firebase init skipped:', e.message));
            }

            // Render landing page tools from config
            App.renderLandingTools();

            // Set landing greeting
            App.updateLandingGreeting();
            App.updateCGLBadge();

            // First-run onboarding for new users
            if (typeof Onboarding !== 'undefined') {
                Onboarding.init();
            }

            // Show reminder badges + check for alerts
            if (typeof Reminders !== 'undefined') {
                Reminders.init();
                Reminders.checkAlerts();
            }

            // Don't auto-init the quoting tool anymore
            // It will init when user clicks the card
            App.observePluginVisibility();

            // ‚îÄ‚îÄ Hash Router: initial route ‚îÄ‚îÄ
            const hash = window.location.hash.replace('#', '');
            if (!hash || hash === 'home') {
                // Default to #home ‚Äî show dashboard
                if (window.location.hash !== '#home') {
                    history.replaceState(null, '', '#home');
                }
                App.goHome();
            } else {
                // Deep-link into a specific tool
                await App.navigateTo(hash, { syncHash: false });
            }

            // ‚îÄ‚îÄ Hash Router: handle back/forward & hash changes ‚îÄ‚îÄ
            window.addEventListener('hashchange', async () => {
                if (App._routerNavigating) return; // guard against programmatic hash sets
                const toolId = window.location.hash.replace('#', '');
                if (!toolId || toolId === 'home') {
                    App.goHome();
                } else {
                    await App.navigateTo(toolId, { syncHash: false });
                }
            });

            // ‚îÄ‚îÄ Desktop Keyboard Shortcuts ‚îÄ‚îÄ
            document.addEventListener('keydown', (e) => {
                // Don't intercept when typing in an input/textarea
                const tag = document.activeElement?.tagName;
                const isInput = tag === 'INPUT' || tag === 'TEXTAREA' || tag === 'SELECT' || document.activeElement?.isContentEditable;
                const mod = e.metaKey || e.ctrlKey;

                // Cmd/Ctrl+S ‚Üí Save current form
                if (mod && e.key === 's') {
                    e.preventDefault();
                    if (App.initialized && App.save) App.save();
                    App.toast('üíæ Saved');
                    return;
                }
                // Escape ‚Üí Go home (unless in a modal/popup)
                if (e.key === 'Escape' && !isInput) {
                    const modal = document.querySelector('.paywall-overlay, .onboarding-overlay[style*="flex"], [class*="popup"][style*="flex"]');
                    if (!modal) {
                        App.goHome();
                    }
                    return;
                }
                // Cmd/Ctrl+K ‚Üí Focus search (future: command palette)
                if (mod && e.key === 'k') {
                    e.preventDefault();
                    // For now, navigate home to show the tool grid
                    App.goHome();
                    return;
                }
                // Enter in wizard steps ‚Üí advance to next step
                if (e.key === 'Enter' && !isInput && App.initialized) {
                    const activeStep = document.querySelector('.step:not(.hidden)');
                    if (activeStep) {
                        e.preventDefault();
                        App.next();
                    }
                }
            });
        };
    </script>
    <script src="js/coi.js"></script>
    <script src="js/prospect.js"></script>

    </div> <!-- End quotingTool container -->

    <!-- COI GENERATOR TOOL CONTAINER -->
    <div id="coiTool" class="plugin-container">
        <!-- Plugin HTML loaded dynamically from plugins/ -->
    </div>

    <!-- PROSPECT INVESTIGATOR TOOL CONTAINER -->
    <div id="prospectTool" class="plugin-container">
        <!-- Plugin HTML loaded dynamically from plugins/ -->
    </div>

    <!-- CGL COMPLIANCE DASHBOARD CONTAINER -->
    <div id="complianceTool" class="plugin-container">
        <!-- Plugin HTML loaded dynamically from plugins/ -->
    </div>

    <!-- POLICY Q&A ASSISTANT TOOL CONTAINER -->
    <div id="qnaTool" class="plugin-container">
        <!-- Plugin HTML loaded dynamically from plugins/ -->
    </div>

    <!-- EMAIL COMPOSER TOOL CONTAINER -->
    <div id="emailTool" class="plugin-container">
        <!-- Plugin HTML loaded dynamically from plugins/ -->
    </div>

    <!-- QUICK REFERENCE TOOL CONTAINER -->
    <div id="quickrefTool" class="plugin-container">
        <!-- Plugin HTML loaded dynamically from plugins/ -->
    </div>

    <!-- ACCOUNTING EXPORT TOOL CONTAINER -->
    <div id="accountingTool" class="plugin-container">
        <!-- Plugin HTML loaded dynamically from plugins/ -->
    </div>

    <!-- HAWKSOFT EXPORT TOOL CONTAINER -->
    <div id="hawksoftTool" class="plugin-container">
        <!-- Plugin HTML loaded dynamically from plugins/ -->
    </div>

    <!-- VIN DECODER TOOL CONTAINER -->
    <div id="vinDecoderTool" class="plugin-container">
        <!-- Plugin HTML loaded dynamically from plugins/ -->
    </div>

    <!-- EZLYNX QUOTER TOOL CONTAINER -->
    <div id="ezlynxTool" class="plugin-container">
        <!-- Plugin HTML loaded dynamically from plugins/ -->
    </div>

    <!-- QUOTE COMPARE TOOL CONTAINER -->
    <div id="quoteCompareTool" class="plugin-container">
        <!-- Plugin HTML loaded dynamically from plugins/ -->
    </div>

    <!-- TASK REMINDERS TOOL CONTAINER -->
    <div id="remindersTool" class="plugin-container">
        <!-- Plugin HTML loaded dynamically from plugins/ -->
    </div>

    <!-- Sync indicator toast -->
    <div id="syncIndicator" class="sync-indicator" style="display:none"></div>

    <!-- ‚ïê‚ïê Auth Modal ‚ïê‚ïê -->
    <div id="authModal" class="auth-modal-overlay" style="display:none">
        <div class="auth-modal">
            <button class="auth-close" onclick="Auth.closeModal()">&times;</button>

            <!-- Login View -->
            <div class="auth-view" data-auth-view="login" style="display:block">
                <div class="auth-brand">
                    <div class="auth-brand-logo">
                        <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path></svg>
                    </div>
                    <div class="auth-brand-name">Altech</div>
                </div>
                <div class="auth-modal-header">
                    <h3>Welcome Back</h3>
                    <p class="auth-subtitle">Sign in to sync your data across devices</p>
                </div>
                <form class="auth-form" onsubmit="Auth.handleLoginSubmit(event)">
                    <div class="auth-field">
                        <label for="authLoginEmail">Email</label>
                        <input type="email" id="authLoginEmail" placeholder="you@company.com" required autocomplete="email">
                    </div>
                    <div class="auth-field">
                        <label for="authLoginPassword">Password</label>
                        <input type="password" id="authLoginPassword" placeholder="Enter your password" required autocomplete="current-password">
                    </div>
                    <div class="auth-error" style="display:none"></div>
                    <button type="submit" class="btn-auth btn-auth-primary">Sign In</button>
                </form>
                <div class="auth-links">
                    <button type="button" class="auth-link" onclick="Auth.switchView('signup')">Create account</button>
                    <button type="button" class="auth-link" onclick="Auth.switchView('reset')">Forgot password?</button>
                </div>
            </div>

            <!-- Signup View -->
            <div class="auth-view" data-auth-view="signup" style="display:none">
                <div class="auth-brand">
                    <div class="auth-brand-logo">
                        <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path></svg>
                    </div>
                    <div class="auth-brand-name">Altech</div>
                </div>
                <div class="auth-modal-header">
                    <h3>Create Account</h3>
                    <p class="auth-subtitle">Get started with cloud sync for your team</p>
                </div>
                <form class="auth-form" onsubmit="Auth.handleSignupSubmit(event)">
                    <div class="auth-field">
                        <label for="authSignupName">Display Name</label>
                        <input type="text" id="authSignupName" placeholder="Your name" autocomplete="name">
                    </div>
                    <div class="auth-field">
                        <label for="authSignupEmail">Email</label>
                        <input type="email" id="authSignupEmail" placeholder="you@company.com" required autocomplete="email">
                    </div>
                    <div class="auth-field">
                        <label for="authSignupPassword">Password</label>
                        <input type="password" id="authSignupPassword" placeholder="At least 6 characters" required minlength="6" autocomplete="new-password">
                    </div>
                    <div class="auth-field">
                        <label for="authSignupConfirm">Confirm Password</label>
                        <input type="password" id="authSignupConfirm" placeholder="Re-enter your password" required minlength="6" autocomplete="new-password">
                    </div>
                    <div class="auth-error" style="display:none"></div>
                    <button type="submit" class="btn-auth btn-auth-primary">Create Account</button>
                </form>
                <div class="auth-links">
                    <button type="button" class="auth-link" onclick="Auth.switchView('login')">Already have an account? Sign in</button>
                </div>
            </div>

            <!-- Reset Password View -->
            <div class="auth-view" data-auth-view="reset" style="display:none">
                <div class="auth-modal-header">
                    <h3>Reset Password</h3>
                    <p class="auth-subtitle">Enter your email and we'll send you a reset link</p>
                </div>
                <form class="auth-form" onsubmit="Auth.handleResetSubmit(event)">
                    <div class="auth-field">
                        <label for="authResetEmail">Email Address</label>
                        <input type="email" id="authResetEmail" placeholder="you@company.com" required autocomplete="email">
                    </div>
                    <div class="auth-error" style="display:none"></div>
                    <div class="auth-success" style="display:none"></div>
                    <button type="submit" class="btn-auth btn-auth-primary">Send Reset Link</button>
                </form>
                <div class="auth-links">
                    <button type="button" class="auth-link" onclick="Auth.switchView('login')">Back to sign in</button>
                </div>
            </div>

            <!-- Account View (signed in) -->
            <div class="auth-view" data-auth-view="account" style="display:none">
                <div class="auth-modal-header">
                    <div class="auth-account-avatar" id="authAccountAvatar">A</div>
                    <h3>Your Account</h3>
                </div>
                <div class="auth-account-info">
                    <div class="auth-field">
                        <label>Email</label>
                        <p id="authAccountEmail" class="auth-readonly"></p>
                    </div>
                    <div class="auth-field">
                        <label for="authAccountName">Display Name</label>
                        <div style="display:flex;gap:0.5rem;align-items:stretch">
                            <input type="text" id="authAccountName" placeholder="Your name" style="flex:1">
                            <button class="btn-auth btn-auth-small btn-auth-secondary" onclick="Auth.updateName(document.getElementById('authAccountName').value)" style="white-space:nowrap">Update</button>
                        </div>
                    </div>
                    <div class="auth-divider">sync</div>
                    <div class="auth-sync-status">
                        <div class="auth-sync-info">
                            <span id="authSyncStatus">Ready to sync</span>
                            <span id="authSyncTimestamp" class="auth-sync-timestamp"></span>
                        </div>
                        <button class="btn-auth btn-auth-small btn-auth-primary" style="margin-top:0;width:auto;padding:0.4rem 1rem" onclick="CloudSync.fullSync()">Sync Now</button>
                    </div>

                    <div class="auth-divider">team</div>
                    <div class="auth-invite-row" onclick="Onboarding.showShareModal()">
                        <span>üë•</span>
                        <div class="auth-invite-text">
                            <strong>Invite Your Team</strong>
                            <span>Share a link so colleagues can access Altech</span>
                        </div>
                        <span class="auth-invite-arrow">‚Ä∫</span>
                    </div>
                </div>
                <div class="auth-account-actions">
                    <button class="btn-auth btn-auth-secondary" onclick="Auth.logout()">Sign Out</button>
                    <button class="btn-auth btn-auth-danger btn-auth-small" onclick="CloudSync.deleteCloudData()">Delete Cloud Data</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Plugin scripts (loaded after DOM) -->
    <script src="js/quick-ref.js"></script>
    <script src="js/accounting-export.js"></script>
    <script src="js/compliance-dashboard.js?v=20260217j"></script>
    <script src="js/ezlynx-tool.js"></script>
    <script src="js/quote-compare.js"></script>
    <script src="js/email-composer.js"></script>
    <script src="js/policy-qa.js"></script>
    <script src="js/reminders.js"></script>
    <script src="js/hawksoft-export.js"></script>
    <script src="js/vin-decoder.js"></script>

<script src="js/data-backup.js"></script>
<script src="js/firebase-config.js"></script>
<script src="js/auth.js"></script>
<script src="js/cloud-sync.js"></script>
<script src="js/paywall.js"></script>
<script src="js/onboarding.js"></script>

</body>
</html>
