<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="apple-touch-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect fill='%230066cc' width='100' height='100'/><text y='70' x='50' text-anchor='middle' font-size='60' fill='white'>AL</text></svg>">
    <title>Altech Field Lead</title>
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/compliance.css">
    <link rel="stylesheet" href="css/email.css">
    <link rel="stylesheet" href="css/quickref.css">
    <link rel="stylesheet" href="css/accounting.css">
    <link rel="stylesheet" href="css/ezlynx.css">
    <link rel="stylesheet" href="css/quote-compare.css">
    <link rel="stylesheet" href="css/intake-assist.css">
    <link rel="stylesheet" href="css/auth.css">
    <link rel="stylesheet" href="css/admin.css">
    <link rel="stylesheet" href="css/theme-professional.css">
    <link rel="stylesheet" href="css/reminders.css">
    <link rel="stylesheet" href="css/hawksoft.css">
    <link rel="stylesheet" href="css/vin-decoder.css">
    <link rel="stylesheet" href="css/onboarding.css">
    <link rel="stylesheet" href="css/paywall.css">
    <link rel="stylesheet" href="css/bug-report.css">
    <link rel="stylesheet" href="css/security-info.css">
    <link rel="stylesheet" href="css/sidebar.css">
    <link rel="stylesheet" href="css/dashboard.css">

    <!-- Vercel Web Analytics -->
    <script defer src="/_vercel/insights/script.js"></script>
    <!-- Vercel Speed Insights -->
    <script defer src="/_vercel/speed-insights/script.js"></script>

    <!-- Firebase SDK (compat mode — no build step needed) -->
    <script defer src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app-compat.js"></script>
    <script defer src="https://www.gstatic.com/firebasejs/10.12.0/firebase-auth-compat.js"></script>
    <script defer src="https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore-compat.js"></script>
</head>
<body>

    <!-- ╔══════════════════════════════════════════════════════════╗ -->
    <!-- ║  ONBOARDING — First-run welcome for new team members     ║ -->
    <!-- ╚══════════════════════════════════════════════════════════╝ -->
    <div id="onboardingOverlay" class="onboarding-overlay" style="display:none">
        <div class="onboarding-card">

            <!-- Step 1: Welcome -->
            <div class="onboarding-step active" data-step="1">
                <div class="onboarding-brand">
                    <div class="onboarding-logo">AL</div>
                    <h2>Welcome to Altech</h2>
                    <p>Your insurance toolkit — built for speed</p>
                </div>
                <ul class="onboarding-features">
                    <li>
                        <div class="onboarding-feature-icon">📷</div>
                        <div class="onboarding-feature-text">
                            <strong>Scan &amp; Auto-Fill</strong>
                            <span>Snap a photo of any policy doc — the form fills itself in seconds</span>
                        </div>
                    </li>
                    <li>
                        <div class="onboarding-feature-icon">📤</div>
                        <div class="onboarding-feature-text">
                            <strong>One-Tap Export</strong>
                            <span>Export to HawkSoft, EZLynx, or PDF with a single tap</span>
                        </div>
                    </li>
                    <li>
                        <div class="onboarding-feature-icon">🔐</div>
                        <div class="onboarding-feature-text">
                            <strong>Secure Cloud Sync</strong>
                            <span>Your data is encrypted and syncs securely across all your devices</span>
                        </div>
                    </li>
                    <li>
                        <div class="onboarding-feature-icon">🛡️</div>
                        <div class="onboarding-feature-text">
                            <strong>CGL &amp; Compliance</strong>
                            <span>Track policy expirations, bonds, and compliance status</span>
                        </div>
                    </li>
                </ul>
                <div class="onboarding-actions">
                    <button class="onboarding-btn onboarding-btn-primary" onclick="Onboarding.next()">Get Started</button>
                </div>
                <div class="onboarding-signin-link">
                    Already have an account? <a href="#" onclick="event.preventDefault(); Onboarding.signInExisting()">Sign in</a>
                </div>
                <div class="onboarding-dots">
                    <div class="onboarding-dot active"></div>
                    <div class="onboarding-dot"></div>
                    <div class="onboarding-dot"></div>
                    <div class="onboarding-dot"></div>
                </div>
            </div>

            <!-- Step 2: Your Name -->
            <div class="onboarding-step" data-step="2">
                <div class="onboarding-brand">
                    <h2>Let's personalize</h2>
                    <p>Tell us your name so we can greet you properly</p>
                </div>
                <div class="onboarding-input-group">
                    <label for="onboardingName">Your first name</label>
                    <input type="text" id="onboardingName" placeholder="e.g. Austin" autocomplete="given-name" maxlength="30">
                    <div class="onboarding-hint">This shows in the dashboard greeting</div>
                </div>
                <div class="onboarding-actions">
                    <button class="onboarding-btn onboarding-btn-secondary" onclick="Onboarding.prev()">Back</button>
                    <button class="onboarding-btn onboarding-btn-primary" onclick="Onboarding.next()">Continue</button>
                </div>
                <div class="onboarding-dots">
                    <div class="onboarding-dot"></div>
                    <div class="onboarding-dot active"></div>
                    <div class="onboarding-dot"></div>
                    <div class="onboarding-dot"></div>
                </div>
            </div>

            <!-- Step 3: Agency Profile -->
            <div class="onboarding-step" data-step="3">
                <div class="onboarding-brand">
                    <h2>Your Agency</h2>
                    <p>Help us tailor the experience for your agency</p>
                </div>
                <div class="onboarding-input-group">
                    <label for="onboardingAgencyName">Agency name</label>
                    <input type="text" id="onboardingAgencyName" placeholder="e.g. Pacific Shield Insurance" autocomplete="organization" maxlength="80">
                </div>
                <div class="onboarding-input-group">
                    <label for="onboardingAgencyState">State</label>
                    <input type="text" id="onboardingAgencyState" placeholder="e.g. CA" autocomplete="address-level1" maxlength="2" style="text-transform:uppercase;letter-spacing:1px;width:80px">
                </div>
                <div class="onboarding-input-group">
                    <label for="onboardingLicenseNum">License number <span style="font-weight:400;color:var(--text-secondary)">(optional)</span></label>
                    <input type="text" id="onboardingLicenseNum" placeholder="e.g. 0K12345" autocomplete="off" maxlength="30">
                </div>
                <div class="onboarding-actions">
                    <button class="onboarding-btn onboarding-btn-secondary" onclick="Onboarding.prev()">Back</button>
                    <button class="onboarding-btn onboarding-btn-primary" onclick="Onboarding.next()">Continue</button>
                </div>
                <div class="onboarding-dots">
                    <div class="onboarding-dot"></div>
                    <div class="onboarding-dot"></div>
                    <div class="onboarding-dot active"></div>
                    <div class="onboarding-dot"></div>
                </div>
            </div>

            <!-- Step 4: Access Code + finish -->
            <div class="onboarding-step" data-step="4">
                <div class="onboarding-brand">
                    <h2>Almost there!</h2>
                    <p>Enter the access code from your team admin to continue</p>
                </div>
                <div class="onboarding-input-group">
                    <label for="onboardingAccessCode">Access Code</label>
                    <input type="text" id="onboardingAccessCode" placeholder="Enter code" autocomplete="off" maxlength="30" style="text-transform:uppercase;letter-spacing:2px;text-align:center;font-size:1.1rem">
                    <div class="onboarding-hint" id="onboardingCodeHint">Ask your manager or team lead for the code</div>
                    <div class="onboarding-code-error" id="onboardingCodeError" style="display:none">Invalid code — please try again</div>
                </div>
                <ul class="onboarding-features" style="margin-top:12px">
                    <li>
                        <div class="onboarding-feature-icon">🔒</div>
                        <div class="onboarding-feature-text">
                            <strong>Why a code?</strong>
                            <span>This protects our tools and data — only authorized team members can access the app</span>
                        </div>
                    </li>
                </ul>
                <div class="onboarding-actions">
                    <button class="onboarding-btn onboarding-btn-secondary" onclick="Onboarding.prev()">Back</button>
                    <button class="onboarding-btn onboarding-btn-primary" onclick="Onboarding.validateCode()">Activate</button>
                </div>
                <div class="onboarding-dots">
                    <div class="onboarding-dot"></div>
                    <div class="onboarding-dot"></div>
                    <div class="onboarding-dot"></div>
                    <div class="onboarding-dot active"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- ╔══════════════════════════════════════════════════════════╗ -->
    <!-- ║  APP SHELL — Desktop Command Center Layout                ║ -->
    <!-- ╚══════════════════════════════════════════════════════════╝ -->
    <div class="app-shell">
        <aside id="appSidebar" class="app-sidebar"></aside>
        <div id="sidebarOverlay" class="sidebar-overlay" onclick="DashboardWidgets.toggleMobileSidebar()"></div>

        <main class="app-main">
            <header id="appHeader" class="app-header"></header>

            <div class="app-content">

    <!-- ╔══════════════════════════════════════════════════════════╗ -->
    <!-- ║  DASHBOARD VIEW — Bento Widget Grid (replaces landing)   ║ -->
    <!-- ╚══════════════════════════════════════════════════════════╝ -->
    <div id="dashboardView" class="dashboard-view">
        <div class="dashboard-ambient-orb orb-1"></div>
        <div class="dashboard-ambient-orb orb-2"></div>
        <div id="dashboardGreeting" class="dashboard-greeting"></div>
        <div class="bento-grid">
            <div id="widgetReminders" class="widget-card widget-reminders"></div>
            <div id="widgetDrafts" class="widget-card widget-drafts"></div>
            <div id="widgetCompliance" class="widget-card widget-compliance"></div>
            <div id="widgetQuickActions" class="widget-card widget-quick-actions"></div>
            <div id="widgetQuickLaunch" class="widget-card widget-quick-launch"></div>
        </div>
    </div>

    <!-- Security & Privacy Info Modal (accessible from anywhere) -->
    <div id="securityInfoOverlay" class="secinfo-overlay" style="display:none" onclick="if(event.target===this)SecurityInfo.close()">
        <div class="secinfo-modal" role="dialog" aria-label="Security & Privacy">
            <div class="secinfo-header">
                <h3>🔒 Security & Privacy</h3>
                <button class="secinfo-close" onclick="SecurityInfo.close()" aria-label="Close">✕</button>
            </div>
            <div class="secinfo-body">
                <p class="secinfo-intro">Altech is built with enterprise-grade security at every layer. Your client data is protected from browser to cloud.</p>

                <div class="secinfo-section">
                    <div class="secinfo-section-icon">🔐</div>
                    <div class="secinfo-section-content">
                        <h4>Authentication</h4>
                        <p>Powered by <strong>Firebase Authentication</strong> with email & password. Tokens are verified server-side on every API call. Session management follows industry best practices.</p>
                    </div>
                </div>

                <div class="secinfo-section">
                    <div class="secinfo-section-icon">🛡️</div>
                    <div class="secinfo-section-content">
                        <h4>Data Isolation</h4>
                        <p><strong>Multi-tenant Firestore rules</strong> enforce strict per-user data isolation. Each account can only read and write its own documents — no cross-tenant access is possible regardless of client-side code. A catch-all deny rule blocks all unspecified paths.</p>
                    </div>
                </div>

                <div class="secinfo-section">
                    <div class="secinfo-section-icon">🔑</div>
                    <div class="secinfo-section-content">
                        <h4>Encryption</h4>
                        <p>Sensitive local data is encrypted with <strong>AES-256-GCM</strong> via the Web Crypto API. Encryption keys are derived using PBKDF2 with SHA-256 and a per-device salt. All cloud communication uses <strong>TLS 1.3</strong> with HSTS enforcement.</p>
                    </div>
                </div>

                <div class="secinfo-section">
                    <div class="secinfo-section-icon">🚦</div>
                    <div class="secinfo-section-content">
                        <h4>API Protection</h4>
                        <p>Every API endpoint is wrapped in security middleware with <strong>per-user rate limiting</strong>, CORS origin whitelisting, and request ID correlation for end-to-end tracing. Authenticated users receive higher rate limits while anonymous requests are throttled.</p>
                    </div>
                </div>

                <div class="secinfo-section">
                    <div class="secinfo-section-icon">🧱</div>
                    <div class="secinfo-section-content">
                        <h4>Security Headers</h4>
                        <ul class="secinfo-list">
                            <li><strong>Strict-Transport-Security</strong> — forces HTTPS</li>
                            <li><strong>Content-Security-Policy</strong> — prevents code injection</li>
                            <li><strong>X-Frame-Options: DENY</strong> — blocks clickjacking</li>
                            <li><strong>X-Content-Type-Options</strong> — prevents MIME sniffing</li>
                            <li><strong>Referrer-Policy</strong> — limits referrer leakage</li>
                            <li><strong>Permissions-Policy</strong> — disables camera, mic, geolocation</li>
                        </ul>
                    </div>
                </div>

                <div class="secinfo-section">
                    <div class="secinfo-section-icon">🧹</div>
                    <div class="secinfo-section-content">
                        <h4>Input Validation & Sanitization</h4>
                        <p>All user inputs are sanitized server-side to prevent XSS and injection attacks. Dedicated validators verify <strong>email, phone, SSN, and ZIP</strong> formats. Field injection is blocked at the Firestore rules layer with explicit allowlists.</p>
                    </div>
                </div>

                <div class="secinfo-section">
                    <div class="secinfo-section-icon">🖥️</div>
                    <div class="secinfo-section-content">
                        <h4>Server Hardening</h4>
                        <p>Path traversal attacks are blocked. Dotfiles, hidden directories, and sensitive paths return 403. Payloads are size-limited to prevent abuse. Static files are served with no-cache headers.</p>
                    </div>
                </div>

                <div class="secinfo-section">
                    <div class="secinfo-section-icon">📋</div>
                    <div class="secinfo-section-content">
                        <h4>Data Handling</h4>
                        <p>Client data is stored locally in your browser and syncs to your private cloud namespace when signed in. <strong>No data is shared between accounts.</strong> Exported files (CMSMTF, XML, PDF) are generated client-side and never pass through our servers. You can delete all cloud data at any time from Settings.</p>
                    </div>
                </div>

                <div class="secinfo-footer-note">
                    <p>Questions about security? <a href="mailto:austin@altech.agency">Contact us</a></p>
                </div>
            </div>
        </div>
    </div>

    <!-- ╔══════════════════════════════════════════════════════════╗ -->
    <!-- ║  PLUGIN VIEWPORT — Contains all tool containers          ║ -->
    <!-- ╚══════════════════════════════════════════════════════════╝ -->
    <div id="pluginViewport" class="plugin-viewport" style="display:none">

    <!-- BACK BUTTON (legacy, hidden — sidebar provides navigation) -->
    <a id="backToHome" href="#home" onclick="App.goHome(); return false;" style="display:none">← Exit Tool</a>
    <div id="breadcrumbBar" style="display:none"></div>

    <!-- QUOTING TOOL CONTAINER -->
    <div id="quotingTool" class="plugin-container">
        <!-- Plugin HTML loaded dynamically from plugins/ -->
    </div> <!-- End quotingTool container -->

    <!-- COI GENERATOR TOOL CONTAINER -->
    <div id="coiTool" class="plugin-container">
        <!-- Plugin HTML loaded dynamically from plugins/ -->
    </div>

    <!-- PROSPECT INVESTIGATOR TOOL CONTAINER -->
    <div id="prospectTool" class="plugin-container">
        <!-- Plugin HTML loaded dynamically from plugins/ -->
    </div>

    <!-- CGL COMPLIANCE DASHBOARD CONTAINER -->
    <div id="complianceTool" class="plugin-container">
        <!-- Plugin HTML loaded dynamically from plugins/ -->
    </div>

    <!-- POLICY Q&A ASSISTANT TOOL CONTAINER -->
    <div id="qnaTool" class="plugin-container">
        <!-- Plugin HTML loaded dynamically from plugins/ -->
    </div>

    <!-- AI INTAKE ASSISTANT TOOL CONTAINER -->
    <div id="intakeTool" class="plugin-container">
        <!-- Plugin HTML loaded dynamically from plugins/ -->
    </div>

    <!-- EMAIL COMPOSER TOOL CONTAINER -->
    <div id="emailTool" class="plugin-container">
        <!-- Plugin HTML loaded dynamically from plugins/ -->
    </div>

    <!-- QUICK REFERENCE TOOL CONTAINER -->
    <div id="quickrefTool" class="plugin-container">
        <!-- Plugin HTML loaded dynamically from plugins/ -->
    </div>

    <!-- ACCOUNTING EXPORT TOOL CONTAINER -->
    <div id="accountingTool" class="plugin-container">
        <!-- Plugin HTML loaded dynamically from plugins/ -->
    </div>

    <!-- HAWKSOFT EXPORT TOOL CONTAINER -->
    <div id="hawksoftTool" class="plugin-container">
        <!-- Plugin HTML loaded dynamically from plugins/ -->
    </div>

    <!-- VIN DECODER TOOL CONTAINER -->
    <div id="vinDecoderTool" class="plugin-container">
        <!-- Plugin HTML loaded dynamically from plugins/ -->
    </div>

    <!-- EZLYNX QUOTER TOOL CONTAINER -->
    <div id="ezlynxTool" class="plugin-container">
        <!-- Plugin HTML loaded dynamically from plugins/ -->
    </div>

    <!-- QUOTE COMPARE TOOL CONTAINER -->
    <div id="quoteCompareTool" class="plugin-container">
        <!-- Plugin HTML loaded dynamically from plugins/ -->
    </div>

    <!-- TASK REMINDERS TOOL CONTAINER -->
    <div id="remindersTool" class="plugin-container">
        <!-- Plugin HTML loaded dynamically from plugins/ -->
    </div>

    </div><!-- /pluginViewport -->

    </div><!-- /app-content -->
    </main>
    </div><!-- /app-shell -->

    <!-- Mobile Bottom Nav (rendered by DashboardWidgets) -->
    <nav id="mobileBottomNav" class="mobile-bottom-nav"></nav>

    <!-- Sync indicator toast -->
    <div id="syncIndicator" class="sync-indicator" style="display:none"></div>

    <!-- Global toast notification -->
    <div id="toast" class="toast">Message</div>

    <!-- ══ Auth Modal ══ -->
    <div id="authModal" class="auth-modal-overlay" style="display:none">
        <div class="auth-modal">
            <button class="auth-close" onclick="Auth.closeModal()">&times;</button>

            <!-- Login View -->
            <div class="auth-view" data-auth-view="login" style="display:block">
                <div class="auth-brand">
                    <div class="auth-brand-logo">
                        <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path></svg>
                    </div>
                    <div class="auth-brand-name">Altech</div>
                </div>
                <div class="auth-modal-header">
                    <h3>Welcome Back</h3>
                    <p class="auth-subtitle">Sign in to sync your data across devices</p>
                </div>
                <form class="auth-form" onsubmit="Auth.handleLoginSubmit(event)">
                    <div class="auth-field">
                        <label for="authLoginEmail">Email</label>
                        <input type="email" id="authLoginEmail" placeholder="you@company.com" required autocomplete="email">
                    </div>
                    <div class="auth-field">
                        <label for="authLoginPassword">Password</label>
                        <input type="password" id="authLoginPassword" placeholder="Enter your password" required autocomplete="current-password">
                    </div>
                    <div class="auth-error" style="display:none"></div>
                    <button type="submit" class="btn-auth btn-auth-primary">Sign In</button>
                </form>
                <div class="auth-links">
                    <button type="button" class="auth-link" onclick="Auth.switchView('signup')">Create account</button>
                    <button type="button" class="auth-link" onclick="Auth.switchView('reset')">Forgot password?</button>
                </div>
            </div>

            <!-- Signup View -->
            <div class="auth-view" data-auth-view="signup" style="display:none">
                <div class="auth-brand">
                    <div class="auth-brand-logo">
                        <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path></svg>
                    </div>
                    <div class="auth-brand-name">Altech</div>
                </div>
                <div class="auth-modal-header">
                    <h3>Create Account</h3>
                    <p class="auth-subtitle">Get started with cloud sync for your team</p>
                </div>
                <form class="auth-form" onsubmit="Auth.handleSignupSubmit(event)">
                    <div class="auth-field">
                        <label for="authSignupName">Display Name</label>
                        <input type="text" id="authSignupName" placeholder="Your name" autocomplete="name">
                    </div>
                    <div class="auth-field">
                        <label for="authSignupEmail">Email</label>
                        <input type="email" id="authSignupEmail" placeholder="you@company.com" required autocomplete="email">
                    </div>
                    <div class="auth-field">
                        <label for="authSignupInviteCode">Invite Code</label>
                        <input type="text" id="authSignupInviteCode" placeholder="Enter invite code" required autocomplete="off" maxlength="30" style="text-transform:uppercase;letter-spacing:1px">
                    </div>
                    <div class="auth-field">
                        <label for="authSignupPassword">Password</label>
                        <input type="password" id="authSignupPassword" placeholder="At least 6 characters" required minlength="6" autocomplete="new-password">
                    </div>
                    <div class="auth-field">
                        <label for="authSignupConfirm">Confirm Password</label>
                        <input type="password" id="authSignupConfirm" placeholder="Re-enter your password" required minlength="6" autocomplete="new-password">
                    </div>
                    <div class="auth-error" style="display:none"></div>
                    <button type="submit" class="btn-auth btn-auth-primary">Create Account</button>
                </form>
                <div class="auth-links">
                    <button type="button" class="auth-link" onclick="Auth.switchView('login')">Already have an account? Sign in</button>
                </div>
            </div>

            <!-- Reset Password View -->
            <div class="auth-view" data-auth-view="reset" style="display:none">
                <div class="auth-modal-header">
                    <h3>Reset Password</h3>
                    <p class="auth-subtitle">Enter your email and we'll send you a reset link</p>
                </div>
                <form class="auth-form" onsubmit="Auth.handleResetSubmit(event)">
                    <div class="auth-field">
                        <label for="authResetEmail">Email Address</label>
                        <input type="email" id="authResetEmail" placeholder="you@company.com" required autocomplete="email">
                    </div>
                    <div class="auth-error" style="display:none"></div>
                    <div class="auth-success" style="display:none"></div>
                    <button type="submit" class="btn-auth btn-auth-primary">Send Reset Link</button>
                </form>
                <div class="auth-links">
                    <button type="button" class="auth-link" onclick="Auth.switchView('login')">Back to sign in</button>
                </div>
            </div>

            <!-- Account View (signed in) -->
            <div class="auth-view" data-auth-view="account" style="display:none">
                <div class="auth-modal-header">
                    <div class="auth-account-avatar" id="authAccountAvatar">A</div>
                    <h3>Your Account</h3>
                </div>
                <div class="auth-account-info">
                    <!-- Profile -->
                    <div class="auth-field">
                        <label>Email</label>
                        <p id="authAccountEmail" class="auth-readonly"></p>
                    </div>
                    <div class="auth-field">
                        <label for="authAccountName">Display Name</label>
                        <div style="display:flex;gap:0.5rem;align-items:stretch">
                            <input type="text" id="authAccountName" placeholder="Your name" style="flex:1">
                            <button class="btn-auth btn-auth-small btn-auth-secondary" onclick="Auth.updateName(document.getElementById('authAccountName').value)" style="white-space:nowrap">Update</button>
                        </div>
                    </div>

                    <!-- ☁️ Sync -->
                    <details class="settings-section">
                        <summary class="settings-section-header">
                            <span class="settings-section-icon">☁️</span>
                            <span class="settings-section-title">Sync</span>
                            <span class="settings-section-chevron">›</span>
                        </summary>
                        <div class="settings-section-body">
                            <div class="auth-sync-status">
                                <div class="auth-sync-info">
                                    <span id="authSyncStatus">Ready to sync</span>
                                    <span id="authSyncTimestamp" class="auth-sync-timestamp"></span>
                                </div>
                                <button class="btn-auth btn-auth-small btn-auth-primary" style="margin-top:0;width:auto;padding:0.4rem 1rem" onclick="CloudSync.fullSync()">Sync Now</button>
                            </div>
                        </div>
                    </details>

                    <!-- 🤖 AI Model -->
                    <details class="settings-section">
                        <summary class="settings-section-header">
                            <span class="settings-section-icon">🤖</span>
                            <span class="settings-section-title">AI Model</span>
                            <span id="aiSettingsBadge" class="settings-section-badge"></span>
                            <span class="settings-section-chevron">›</span>
                        </summary>
                        <div class="settings-section-body" id="aiSettingsSection">
                            <div class="auth-field">
                                <label for="aiProviderSelect">Provider</label>
                                <select id="aiProviderSelect" onchange="App.onAIProviderChange()" class="settings-select">
                                    <option value="google">Google Gemini (default)</option>
                                    <option value="openrouter">OpenRouter (100+ models)</option>
                                    <option value="openai">OpenAI</option>
                                    <option value="anthropic">Anthropic (Claude)</option>
                                </select>
                            </div>
                            <div class="auth-field">
                                <label for="aiModelSelect">Model</label>
                                <select id="aiModelSelect" onchange="App.onAIModelChange()" class="settings-select">
                                </select>
                            </div>
                            <div id="aiModelInfo" class="ai-model-info-card" style="display:none">
                                <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:4px">
                                    <strong id="aiModelInfoName" style="font-size:13px;color:var(--text)"></strong>
                                    <span id="aiModelInfoCost" style="font-weight:600;color:var(--apple-blue);font-size:12px"></span>
                                </div>
                                <div id="aiModelInfoContext" style="color:var(--text-secondary);font-size:11px;margin-bottom:5px"></div>
                                <div id="aiModelInfoTags" style="display:flex;flex-wrap:wrap;gap:4px"></div>
                                <button id="aiCostToggle" onclick="App.toggleCostEstimates()" style="display:block;margin-top:6px;background:none;border:none;color:var(--apple-blue);font-size:11px;cursor:pointer;padding:0;font-weight:500">▼ Show cost per tool</button>
                            </div>
                            <div id="aiCostEstimates" class="ai-cost-card" style="display:none">
                                <div style="font-weight:600;font-size:12px;color:var(--text);margin-bottom:6px">💰 Estimated Cost Per Tool</div>
                                <table id="aiCostTable" style="width:100%;border-collapse:collapse"></table>
                                <p style="margin:6px 0 0;font-size:10px;color:var(--text-secondary);line-height:1.4">Estimates assume typical usage. Actual costs vary with document length, image count, and response complexity.</p>
                            </div>
                            <div class="auth-field">
                                <label for="aiApiKeyInput">API Key <a id="aiKeyLink" href="https://aistudio.google.com/apikey" target="_blank" rel="noopener" style="font-weight:400;font-size:11px;color:var(--apple-blue)">(get key)</a></label>
                                <div style="display:flex;gap:0.5rem;align-items:stretch">
                                    <input type="password" id="aiApiKeyInput" placeholder="AIza..." style="flex:1" autocomplete="off">
                                    <button class="btn-auth btn-auth-small btn-auth-secondary" onclick="App.toggleAIKeyVisibility()" style="white-space:nowrap;padding:0.4rem 0.6rem" title="Show/hide key">👁</button>
                                </div>
                            </div>
                            <div style="display:flex;gap:0.5rem;margin-top:0.25rem">
                                <button class="btn-auth btn-auth-small btn-auth-primary" onclick="App.saveAISettings()" style="flex:1;margin-top:0">Save</button>
                                <button class="btn-auth btn-auth-small btn-auth-secondary" onclick="App.testAIConnection()" id="aiTestBtn" style="flex:1;margin-top:0">Test Connection</button>
                            </div>
                            <div id="aiTestResult" style="display:none;margin-top:0.5rem;padding:8px 12px;border-radius:8px;font-size:12px"></div>
                            <p id="aiProviderHint" style="margin:0.5rem 0 0;font-size:11px;color:var(--text-secondary);line-height:1.4">Gemini 2.5 Flash is used by default. Add your own key for any provider to use premium models.</p>
                        </div>
                    </details>

                    <!-- 🔒 Security -->
                    <details class="settings-section">
                        <summary class="settings-section-header">
                            <span class="settings-section-icon">🔒</span>
                            <span class="settings-section-title">Security</span>
                            <span class="settings-section-chevron">›</span>
                        </summary>
                        <div class="settings-section-body" id="authChangePasswordSection">
                            <form id="authChangePwForm" class="auth-form" onsubmit="Auth.handleChangePasswordSubmit(event)">
                                <div class="auth-field">
                                    <label for="authCurrentPassword">Current Password</label>
                                    <input type="password" id="authCurrentPassword" placeholder="Current password" required autocomplete="current-password">
                                </div>
                                <div class="auth-field">
                                    <label for="authNewPassword">New Password</label>
                                    <input type="password" id="authNewPassword" placeholder="New password (min 6 chars)" required minlength="6" autocomplete="new-password">
                                </div>
                                <div class="auth-field">
                                    <label for="authConfirmNewPassword">Confirm New Password</label>
                                    <input type="password" id="authConfirmNewPassword" placeholder="Confirm new password" required minlength="6" autocomplete="new-password">
                                </div>
                                <div class="auth-error" style="display:none"></div>
                                <div class="auth-success" style="display:none"></div>
                                <button type="submit" class="btn-auth btn-auth-primary" style="margin-top:0.25rem">Update Password</button>
                            </form>
                        </div>
                    </details>

                    <!-- 👥 Team -->
                    <details class="settings-section" id="authInviteSection" style="display:none">
                        <summary class="settings-section-header">
                            <span class="settings-section-icon">👥</span>
                            <span class="settings-section-title">Team</span>
                            <span class="settings-section-chevron">›</span>
                        </summary>
                        <div class="settings-section-body">
                            <div class="auth-invite-row" onclick="Onboarding.showShareModal()">
                                <span>👥</span>
                                <div class="auth-invite-text">
                                    <strong>Invite Your Team</strong>
                                    <span>Share a link so colleagues can access Altech</span>
                                </div>
                                <span class="auth-invite-arrow">›</span>
                            </div>
                            <div id="authAdminSection" class="auth-invite-row" style="display:none;margin-top:0.5rem" onclick="AdminPanel.open()">
                                <span>🛡️</span>
                                <div class="auth-invite-text">
                                    <strong>User Management</strong>
                                    <span>View users, grant admin, block accounts</span>
                                </div>
                                <span class="auth-invite-arrow">›</span>
                            </div>
                        </div>
                    </details>
                </div>
                <div class="auth-account-actions">
                    <button class="btn-auth btn-auth-secondary" onclick="Auth.logout()">Sign Out</button>
                    <button class="btn-auth btn-auth-danger btn-auth-small" onclick="CloudSync.deleteCloudData()">Delete Cloud Data</button>
                </div>
            </div>
        </div>
    </div>

    <!-- CDN Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf-lib/1.17.1/pdf-lib.min.js"></script>
    <script>if(window.pdfjsLib){pdfjsLib.GlobalWorkerOptions.workerSrc='https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';}</script>
    <script src="js/crypto-helper.js"></script>

    <!-- App initialization: state, workflows, toolConfig registry -->
    <script src="js/app-init.js"></script>

    <!-- App modules (core first, then features) -->
    <script src="js/app-core.js"></script>
    <script src="js/app-scan.js"></script>
    <script src="js/app-property.js"></script>
    <script src="js/app-vehicles.js"></script>
    <script src="js/app-popups.js"></script>
    <script src="js/app-export.js"></script>
    <script src="js/app-quotes.js"></script>

    <!-- AI Provider (must load before plugins that use it) -->
    <script src="js/ai-provider.js"></script>

    <!-- Dashboard widgets (command center bento layout) -->
    <script src="js/dashboard-widgets.js"></script>

    <!-- Plugin scripts (loaded after DOM) -->
    <script src="js/coi.js"></script>
    <script src="js/prospect.js"></script>
    <script src="js/quick-ref.js"></script>
    <script src="js/accounting-export.js"></script>
    <script src="js/compliance-dashboard.js?v=20260217j"></script>
    <script src="js/ezlynx-tool.js"></script>
    <script src="js/quote-compare.js"></script>
    <script src="js/intake-assist.js"></script>
    <script src="js/email-composer.js"></script>
    <script src="js/policy-qa.js"></script>
    <script src="js/reminders.js"></script>
    <script src="js/hawksoft-export.js"></script>
    <script src="js/vin-decoder.js"></script>

<script src="js/data-backup.js"></script>
<script src="js/bug-report.js"></script>
<script src="js/firebase-config.js"></script>
<script src="js/auth.js"></script>
<script src="js/admin-panel.js"></script>
<script src="js/cloud-sync.js"></script>
<script src="js/paywall.js"></script>
<script src="js/onboarding.js"></script>

<!-- Boot sequence: error boundaries, SW registration, window.onload, hash router, keyboard shortcuts, SecurityInfo, 3D tilt -->
<script src="js/app-boot.js"></script>

</body>
</html>
