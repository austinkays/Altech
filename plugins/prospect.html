<style>
    .ai-pulse { animation: aiPulse 2s ease-in-out infinite; }
    @keyframes aiPulse { 0%, 100% { opacity: 1; transform: scale(1); } 50% { opacity: 0.6; transform: scale(1.05); } }
</style>
<header>
    <div class="header-top">
        <div class="logo tool-header-brand">
            <span class="logo-controls">
                <button type="button" class="logo-icon-button" onclick="App.goHome()" aria-label="Back to home">
                    <span class="logo-icon"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg></span>
                </button>
                <button class="dark-mode-toggle" onclick="App.toggleDarkMode()" title="Toggle dark mode" aria-label="Toggle dark mode">
                    <span class="dark-mode-icon"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/></svg></span>
                </button>
            </span>
            <span>Prospect Investigator</span>
        </div>
        <div style="display: flex; gap: 12px; align-items: center;">
            <button class="btn-utility" onclick="ProspectInvestigator.exportReport()" style="font-size: 14px; padding: 8px 16px;">
                ğŸ–¨ï¸ Print Report
            </button>
        </div>
    </div>
    <div class="step-title">AI-Powered Commercial Intelligence Â· WA / OR / AZ</div>
    <div class="progress-track"><div class="progress-fill" style="width: 100%;"></div></div>
</header>

<main style="padding: 20px; padding-bottom: 60px;">

    <!-- SEARCH SECTION -->
    <div class="card">
        <h2>ğŸ” Search Business</h2>
        <p class="section-subtitle">Lookup by business name, UBI number, or contractor registration</p>

        <div class="grid-2">
            <div>
                <label class="label">Business Name</label>
                <input type="text" id="prospectBusinessName" placeholder="e.g., ABC Construction LLC">
            </div>
            <div>
                <label class="label">UBI / CCB# (Optional)</label>
                <input type="text" id="prospectUBI" placeholder="e.g., 123-456-789 or CCB#">
            </div>
        </div>

        <div class="grid-2" style="margin-top: 16px;">
            <div>
                <label class="label">City</label>
                <input type="text" id="prospectCity" placeholder="e.g., Seattle">
            </div>
            <div>
                <label class="label">State</label>
                <select id="prospectState">
                    <option value="WA">Washington</option>
                    <option value="OR">Oregon</option>
                    <option value="AZ">Arizona</option>
                </select>
            </div>
        </div>

        <button class="btn" onclick="ProspectInvestigator.search()" style="margin-top: 20px; width: 100%; background: var(--apple-blue); color: #fff; font-size: 15px; font-weight: 600; padding: 14px 18px; border-radius: 12px; border: none; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 8px;">
            <span style="font-size: 10px; width: 10px; height: 10px; background: #34C759; border-radius: 50%; display: inline-block; box-shadow: 0 0 6px rgba(52,199,89,0.6);"></span>
            Run Full Investigation
        </button>
    </div>

    <!-- LOADING INDICATOR -->
    <div id="prospectLoading" style="display: none; text-align: center; padding: 40px;">
        <div style="font-size: 48px; margin-bottom: 16px;">â³</div>
        <h3>Investigating Business Records...</h3>
        <p style="color: var(--text-secondary);">Searching WA L&I, Secretary of State, OSHA, and other public databases</p>
    </div>

    <!-- RESULTS SECTION -->
    <div id="prospectResults" style="display: none;">

        <!-- BUSINESS SUMMARY -->
        <div class="card">
            <h2>ğŸ¢ Business Summary</h2>
            <div id="businessSummary"></div>
        </div>

        <!-- AI ANALYSIS (Gemini-powered â€” shows after data loads) -->
        <div id="aiAnalysisSection" class="card" style="display: none; border: 2px solid rgba(0,122,255,0.2); background: linear-gradient(135deg, var(--bg-card), rgba(0,122,255,0.02));">
            <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 16px;">
                <span style="font-size: 24px;">ğŸ§ </span>
                <div>
                    <h2 style="margin: 0; font-size: 18px;">AI Underwriting Analysis</h2>
                    <p style="margin: 0; font-size: 12px; color: var(--text-secondary);">Gemini-powered risk intelligence</p>
                </div>
            </div>
            <div id="aiAnalysisContent"></div>
        </div>

        <!-- L&I CONTRACTOR INFO -->
        <div class="card">
            <h2>ğŸ”¨ Contractor License</h2>
            <div id="liContractorInfo"></div>
        </div>

        <!-- SECRETARY OF STATE -->
        <div class="card">
            <h2>ğŸ“‹ Business Entity Records</h2>
            <div id="sosBusinessInfo"></div>
        </div>

        <!-- OSHA VIOLATIONS -->
        <div class="card">
            <h2>âš ï¸ OSHA Inspection History</h2>
            <div id="oshaViolations"></div>
        </div>

        <!-- SAM.GOV FEDERAL REGISTRATION -->
        <div id="samGovSection" class="card" style="display: none;">
            <h2>ğŸ›ï¸ SAM.gov Federal Registration</h2>
            <p style="color: var(--text-secondary); margin-bottom: 12px; font-size: 13px;">
                Federal entity registration, CAGE codes, and government contracting eligibility
            </p>
            <div id="samGovInfo"></div>
        </div>

        <!-- RISK CLASSIFICATION -->
        <div class="card">
            <h2>ğŸ“Š Risk Classification</h2>
            <div id="riskClassification"></div>
        </div>

        <!-- INVESTIGATION LINKS -->
        <div class="card">
            <h2>ğŸ”— Investigation Links</h2>
            <p style="color: var(--text-secondary); margin-bottom: 16px; font-size: 13px;">
                Open official records in new tabs for detailed manual review
            </p>
            <div id="investigationLinks"></div>
        </div>

        <!-- EXPORT ACTIONS -->
        <div class="card" style="border: 2px dashed var(--border);">
            <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 12px;">
                <div>
                    <h3 style="margin: 0 0 4px 0; font-size: 16px;">ğŸ“‹ Export Options</h3>
                    <p style="margin: 0; font-size: 13px; color: var(--text-secondary);">
                        Export this investigation report for your workflow
                    </p>
                </div>
                <div style="display: flex; gap: 12px;">
                    <button class="btn-secondary" onclick="ProspectInvestigator.copyToQuote()" style="font-size: 14px;">
                        ğŸ“‹ Copy to Quote
                    </button>
                    <button class="btn-utility" onclick="ProspectInvestigator.exportReport()" style="font-size: 14px;">
                        ğŸ–¨ï¸ Print Report
                    </button>
                </div>
            </div>
        </div>

    </div>

</main>
