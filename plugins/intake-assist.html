
<header>
    <div class="header-top">
        <div class="logo tool-header-brand">
            <span class="logo-controls">
                <button type="button" class="logo-icon-button" onclick="App.goHome()" aria-label="Back to home">
                    <span class="logo-icon"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg></span>
                </button>
                <button class="dark-mode-toggle" onclick="App.toggleDarkMode()" title="Toggle dark mode" aria-label="Toggle dark mode">
                    <span class="dark-mode-icon"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/></svg></span>
                </button>
            </span>
            <span>AI Intake</span>
        </div>
    </div>
</header>

<!-- Mobile tab bar (hidden on desktop via CSS) -->
<div class="ia-tab-bar" id="iaTabBar">
    <button class="ia-tab ia-tab-active" data-tab="chat" onclick="IntakeAssist.switchTab('chat')">
        <svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></svg>
        Chat
    </button>
    <button class="ia-tab" data-tab="data" onclick="IntakeAssist.switchTab('data')">
        <svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/></svg>
        Data
        <span id="iaTabBadge" class="ia-tab-badge">0%</span>
    </button>
</div>

<main class="ia-main">
    <div class="ia-layout">

        <!-- ‚ïê‚ïê‚ïê Chat Pane ‚ïê‚ïê‚ïê -->
        <div class="ia-chat-pane" id="iaChatPane">
            <div class="ia-card ia-chat-card">
                <div class="ia-card-header">
                    <span class="ia-card-icon">ü§ñ</span>
                    <span class="ia-card-title">AI Intake</span>
                    <button class="ia-clear-btn" onclick="IntakeAssist.clearChat()" title="Clear conversation">
                        <svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><polyline points="3 6 5 6 21 6"/><path d="M19 6l-1 14a2 2 0 0 1-2 2H8a2 2 0 0 1-2-2L5 6"/><path d="M10 11v6"/><path d="M14 11v6"/><path d="M9 6V4a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v2"/></svg>
                    </button>
                </div>

                <div id="iaChatMessages" class="ia-messages"></div>

                <!-- Drag-drop overlay (shown when files are dragged over chat) -->
                <div id="iaDropOverlay" class="ia-drop-overlay">
                    <div class="ia-drop-content">
                        <svg class="ia-drop-icon" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                            <polyline points="14 2 14 8 20 8"/>
                            <line x1="12" y1="18" x2="12" y2="12"/>
                            <polyline points="9 15 12 12 15 15"/>
                        </svg>
                        <div class="ia-drop-title">Drop policy document</div>
                        <div class="ia-drop-subtitle">PDF, photo, or scan ‚Äî AI will extract all data</div>
                    </div>
                </div>

                <!-- Smart suggestion chips -->
                <div id="iaChipRow" class="ia-chip-row"></div>

                <!-- Input row -->
                <input type="file" id="iaDocInput" accept=".pdf,image/*" style="display:none">
                <div class="ia-input-row">
                    <button id="iaDocBtn" class="ia-input-icon-btn" title="Upload document" aria-label="Upload document">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21.44 11.05l-9.19 9.19a6 6 0 0 1-8.49-8.49l9.19-9.19a4 4 0 0 1 5.66 5.66l-9.2 9.19a2 2 0 0 1-2.83-2.83l8.49-8.48"/></svg>
                    </button>
                    <textarea
                        id="iaInput"
                        class="ia-input"
                        placeholder="Describe your client or drop a policy document..."
                        rows="1"
                    ></textarea>
                    <button id="iaSendBtn" class="ia-send-btn" onclick="IntakeAssist.sendMessage()" title="Send (Enter)">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><line x1="22" y1="2" x2="11" y2="13"/><polygon points="22 2 15 22 11 13 2 9 22 2"/></svg>
                    </button>
                </div>
            </div>
        </div>

        <!-- ‚ïê‚ïê‚ïê Sidebar Pane (Data + Intel) ‚ïê‚ïê‚ïê -->
        <div class="ia-sidebar-pane" id="iaSidebarPane">

            <!-- Sidebar Header: Progress + Actions -->
            <div class="ia-sidebar-header" id="iaSidebarHeader" style="display:none;">
                <div class="ia-sidebar-progress">
                    <svg class="ia-ring-sm" viewBox="0 0 36 36">
                        <circle cx="18" cy="18" r="15" fill="none" stroke="var(--border)" stroke-width="3"/>
                        <circle id="iaProgressArc" cx="18" cy="18" r="15" fill="none" stroke="var(--apple-blue)" stroke-width="3"
                                stroke-dasharray="94.2" stroke-dashoffset="94.2" stroke-linecap="round"
                                transform="rotate(-90 18 18)" style="transition: stroke-dashoffset 0.5s ease;"/>
                    </svg>
                    <span class="ia-sidebar-pct"><span id="iaProgressPercent">0</span>%</span>
                </div>
                <div class="ia-sidebar-actions">
                    <button id="iaCopyBtn" class="ia-copy-btn" onclick="IntakeAssist._copySnapshot()" title="Copy summary to clipboard" aria-label="Copy summary">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg>
                    </button>
                    <button class="ia-export-btn" onclick="IntakeAssist.exportSnapshot()" title="Export current data">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
                        Export
                    </button>
                    <button class="ia-populate-btn-sm" onclick="IntakeAssist.populateForm()" title="Fill intake form">‚ö° Populate</button>
                </div>
            </div>

            <!-- Collapsible Data Sections (populated by JS) -->
            <div id="iaExtractedPreview" class="ia-sections-wrap"></div>

            <!-- Map Panel -->
            <div id="iaMapPanel" class="ia-sidebar-card" style="display:none;">
                <div class="ia-sidebar-card-header">
                    <span>üó∫Ô∏è Property View</span>
                    <button class="ia-map-expand-btn" onclick="IntakeAssist.openFullMap()" title="Open in Google Maps">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" y1="14" x2="21" y2="3"/></svg>
                    </button>
                </div>
                <div class="ia-map-grid">
                    <div class="ia-map-frame">
                        <div class="ia-map-label">Street View</div>
                        <img id="iaStreetView" class="ia-map-img" alt="Street view" />
                        <div id="iaStreetViewEmpty" class="ia-map-empty">Awaiting address...</div>
                    </div>
                    <div class="ia-map-frame">
                        <div class="ia-map-label">Satellite</div>
                        <img id="iaSatelliteView" class="ia-map-img" alt="Satellite view" />
                        <div id="iaSatelliteEmpty" class="ia-map-empty">Awaiting address...</div>
                    </div>
                </div>
                <div id="iaMapAddress" class="ia-map-address"></div>
            </div>

            <!-- Vehicle Panel -->
            <div id="iaVehiclePanel" class="ia-sidebar-card" style="display:none;">
                <div class="ia-sidebar-card-header">
                    <span>üöó Vehicle Info</span>
                </div>
                <div id="iaVehicleInfo" class="ia-vehicle-info"></div>
            </div>

            <!-- Phase 1: Market Intelligence Card -->
            <div id="iaMarketIntelCard" class="ia-sidebar-card" style="display:none;">
                <div class="ia-sidebar-card-header">
                    <span>üìà Market Intelligence</span>
                </div>
                <div class="ia-sidebar-card-body ia-market-intel-body"></div>
            </div>

            <!-- Phase 4: Insurance Trends Card (default collapsed) -->
            <div id="iaInsuranceTrendCard" class="ia-sidebar-card ia-section ia-collapsed" style="display:none;">
                <button class="ia-sidebar-card-header ia-section-header" onclick="this.parentElement.classList.toggle('ia-collapsed')">
                    <span>üè† Insurance Trends</span>
                    <svg class="ia-section-chevron" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"/></svg>
                </button>
                <div class="ia-sidebar-card-body ia-section-body ia-insurance-body"></div>
            </div>

            <!-- Empty state -->
            <div id="iaSidebarEmpty" class="ia-sidebar-empty">
                <div class="ia-sidebar-empty-icon">üìã</div>
                <div class="ia-sidebar-empty-title">No data yet</div>
                <div class="ia-sidebar-empty-text">Start chatting with the AI assistant<br>and extracted data will appear here</div>
            </div>

        </div>

    </div>
</main>
