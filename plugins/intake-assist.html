
<header>
    <div class="header-top">
        <div class="logo tool-header-brand">
            <span class="logo-controls">
                <button type="button" class="logo-icon-button" onclick="App.goHome()" aria-label="Back to home">
                    <span class="logo-icon"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg></span>
                </button>
                <button class="dark-mode-toggle" onclick="App.toggleDarkMode()" title="Toggle dark mode" aria-label="Toggle dark mode">
                    <span class="dark-mode-icon"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/></svg></span>
                </button>
            </span>
            <span>AI Intake</span>
        </div>
    </div>
    <div class="step-title">Describe your client in plain English â€” I'll extract the data and fill the form</div>
</header>

<main style="padding: 16px 16px 80px;">

    <!-- Chat card -->
    <div class="ia-card">
        <div class="ia-card-header">
            <span class="ia-card-icon">ğŸ¤–</span>
            <span class="ia-card-title">AI Intake Assistant</span>
            <button class="ia-clear-btn" onclick="IntakeAssist.clearChat()" title="Clear conversation">
                <svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><polyline points="3 6 5 6 21 6"/><path d="M19 6l-1 14a2 2 0 0 1-2 2H8a2 2 0 0 1-2-2L5 6"/><path d="M10 11v6"/><path d="M14 11v6"/><path d="M9 6V4a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v2"/></svg>
            </button>
        </div>

        <div id="iaChatMessages" class="ia-messages"></div>

        <!-- Quick-start chips -->
        <div class="ia-chip-row">
            <button class="ia-chip" onclick="IntakeAssist.quickStart('home &amp; auto bundle')">ğŸ  Home + Auto</button>
            <button class="ia-chip" onclick="IntakeAssist.quickStart('homeowners')">ğŸ¡ Home Only</button>
            <button class="ia-chip" onclick="IntakeAssist.quickStart('auto')">ğŸš— Auto Only</button>
            <button class="ia-chip" onclick="IntakeAssist.applyAndSend()" style="display:none" id="iaDoneChip">âœ… Done â€” Apply</button>
        </div>

        <!-- Input row -->
        <div class="ia-input-row">
            <textarea
                id="iaInput"
                class="ia-input"
                placeholder="e.g. &quot;John Smith, born March 5 1985, needs home and auto, 123 Main St Vancouver WA 98686&quot;"
                rows="1"
            ></textarea>
            <button id="iaSendBtn" class="ia-send-btn" onclick="IntakeAssist.sendMessage()" title="Send (Enter)">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><line x1="22" y1="2" x2="11" y2="13"/><polygon points="22 2 15 22 11 13 2 9 22 2"/></svg>
            </button>
        </div>
    </div>

    <!-- Extracted data preview (shown once AI returns structured data) -->
    <div id="iaExtractedPreview" class="ia-extracted-card" style="display:none;"></div>

    <!-- Intelligence Panel â€” real-time visual context -->
    <div id="iaIntelPanel" class="ia-intel-panel" style="display:none;">

        <!-- Progress Ring + Field Tracker -->
        <div class="ia-intel-card">
            <div class="ia-intel-header">
                <span>ğŸ“Š Form Progress</span>
                <div class="ia-progress-actions">
                    <button class="ia-export-btn" onclick="IntakeAssist.exportSnapshot()" title="Export current data">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
                        Export
                    </button>
                    <button class="ia-populate-btn-sm" onclick="IntakeAssist.populateForm()" title="Fill intake form">âš¡ Populate</button>
                </div>
            </div>
            <div class="ia-progress-body">
                <div class="ia-progress-ring-wrap">
                    <svg class="ia-progress-ring" viewBox="0 0 80 80">
                        <circle cx="40" cy="40" r="34" fill="none" stroke="var(--border)" stroke-width="6"/>
                        <circle id="iaProgressArc" cx="40" cy="40" r="34" fill="none" stroke="var(--apple-blue)" stroke-width="6"
                                stroke-dasharray="213.6" stroke-dashoffset="213.6" stroke-linecap="round"
                                transform="rotate(-90 40 40)" style="transition: stroke-dashoffset 0.5s ease;"/>
                    </svg>
                    <div class="ia-progress-text">
                        <span id="iaProgressPercent">0</span><span class="ia-progress-pct">%</span>
                    </div>
                </div>
                <div id="iaFieldChecklist" class="ia-field-checklist"></div>
            </div>
        </div>

        <!-- Map Views (shown when address detected) -->
        <div id="iaMapPanel" class="ia-intel-card" style="display:none;">
            <div class="ia-intel-header">
                <span>ğŸ—ºï¸ Property View</span>
                <button class="ia-map-expand-btn" onclick="IntakeAssist.openFullMap()" title="Open in Google Maps">
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" y1="14" x2="21" y2="3"/></svg>
                </button>
            </div>
            <div class="ia-map-grid">
                <div class="ia-map-frame">
                    <div class="ia-map-label">Street View</div>
                    <img id="iaStreetView" class="ia-map-img" alt="Street view" />
                    <div id="iaStreetViewEmpty" class="ia-map-empty">Awaiting address...</div>
                </div>
                <div class="ia-map-frame">
                    <div class="ia-map-label">Satellite</div>
                    <img id="iaSatelliteView" class="ia-map-img" alt="Satellite view" />
                    <div id="iaSatelliteEmpty" class="ia-map-empty">Awaiting address...</div>
                </div>
            </div>
            <div id="iaMapAddress" class="ia-map-address"></div>
        </div>

        <!-- Vehicle Card (shown when vehicle data detected) -->
        <div id="iaVehiclePanel" class="ia-intel-card" style="display:none;">
            <div class="ia-intel-header">
                <span>ğŸš— Vehicle Info</span>
            </div>
            <div id="iaVehicleInfo" class="ia-vehicle-info"></div>
        </div>

    </div>

</main>
